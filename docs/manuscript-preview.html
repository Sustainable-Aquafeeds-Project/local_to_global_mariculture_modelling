<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-GB" xml:lang="en-GB"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.5.56">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


    <title>Local to global N input modelling</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      /* CSS for citations */
      div.csl-bib-body { }
      div.csl-entry {
        clear: both;
        margin-bottom: 0em;
      }
      .hanging-indent div.csl-entry {
        margin-left:2em;
        text-indent:-2em;
      }
      div.csl-left-margin {
        min-width:2em;
        float:left;
      }
      div.csl-right-inline {
        margin-left:2em;
        padding-left:1em;
      }
      div.csl-indent {
        margin-left: 2em;
      }    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script> 
        <link rel="stylesheet" href="extra.css">
      <meta name="citation_title" content="Local to global N input modelling">
<meta name="citation_language" content="en-GB">
<meta name="citation_reference" content="citation_title=Dispersal and assimilation of an aquaculture waste subsidy in a low productivity coastal environment;,citation_author=Camille A. White;,citation_author=P. D. Nichols;,citation_author=D. J. Ross;,citation_author=Tim Dempster;,citation_publication_date=2017-07;,citation_cover_date=2017-07;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.1016/j.marpolbul.2017.05.042;,citation_issue=1-2;,citation_issn=0025326X;,citation_volume=120;,citation_journal_title=Marine Pollution Bulletin;">
<meta name="citation_reference" content="citation_title=Future aquafeeds may compromise reproductive fitness in a marine invertebrate;,citation_author=Camille A. White;,citation_author=Symon A. Dworjanyn;,citation_author=Peter D. Nichols;,citation_author=Benjamin Mos;,citation_author=Tim Dempster;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_fulltext_html_url=https://doi.org/10.1016/j.marenvres.2016.09.008;,citation_issn=18790291;,citation_volume=122;,citation_journal_title=Marine Environmental Research;">
<meta name="citation_reference" content="citation_title=Consumption of aquaculture waste affects the fatty acid metabolism of a benthic invertebrate;,citation_author=Camille White;,citation_author=Raymond J. Bannister;,citation_author=Symon A. Dworjanyn;,citation_author=Vivian Husa;,citation_author=Peter D. Nichols;,citation_author=Tina Kutti;,citation_author=Tim Dempster;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.1016/j.scitotenv.2017.02.109;,citation_volume=586;,citation_journal_title=Science of The Total Environment;">
<meta name="citation_reference" content="citation_title=Aquaculture-derived trophic subsidy boosts populations of an ecosystem engineer;,citation_author=Camille White;,citation_author=Raymond J. Bannister;,citation_author=Symon A. Dworjanyn;,citation_author=Vivian Husa;,citation_author=Peter D. Nichols;,citation_author=Tim Dempster;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.3354/aei00270;,citation_volume=10;,citation_journal_title=Aquaculture Environment Interactions;">
<meta name="citation_reference" content="citation_title=Towards achieving circularity and sustainability in feeds for farmed blue foods;,citation_author=Stefanie M. Colombo;,citation_author=Koushik Roy;,citation_author=Jan Mraz;,citation_author=Alex H. L. Wan;,citation_author=Simon J. Davies;,citation_author=Sean M. Tibbetts;,citation_author=Margareth Øverland;,citation_author=David S. Francis;,citation_author=Melissa M. Rocker;,citation_author=Laura Gasco;,citation_author=Marc Metian;,citation_author=Jesse T. Trushenski;,citation_author=Giovanni M. Turchini;,citation_publication_date=2022-11;,citation_cover_date=2022-11;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1111/raq.12766;,citation_journal_title=Reviews in Aquaculture;">
<meta name="citation_reference" content="citation_title=Insect feed in sustainable crustacean aquaculture;,citation_author=Till Röthig;,citation_author=Annalena Barth;,citation_author=Martin Tschirner;,citation_author=Patrick Schubert;,citation_author=Marius Wenning;,citation_author=André Billion;,citation_author=Thomas Wilke;,citation_author=Andreas Vilcinskas;,citation_publication_date=2023-04;,citation_cover_date=2023-04;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.3920/jiff2022.0117;,citation_issue=9;,citation_volume=9;,citation_journal_title=Journal of Insects as Food and Feed;">
<meta name="citation_reference" content="citation_title=Modeling of nutritional behavior and harvest profit margin in fattening pacu (&amp;amp;amp;lt;i&amp;gt;Piaractus mesopotamicus&amp;lt;/i&amp;gt;) fed on balanced digestible protein contents and raised in an intensive recirculating aquaculture system;,citation_author=Kifayat Ullah Khan;,citation_author=Robert Mervyn Gous;,citation_author=Thiago Matias Torres Nascimento;,citation_author=Nilva Kazue Sakomura;,citation_author=Cleber Fernando Menegasso Mansano;,citation_author=Daniel Monge A. Queiroz;,citation_author=Andressa Tellechea Rodrigues;,citation_author=André Zuffo Boaratti;,citation_author=Rafael de Souza Romaneli;,citation_author=João Batista Kochenborger Fernandes;,citation_publication_date=2022-09;,citation_cover_date=2022-09;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1016/j.anifeedsci.2022.115430;,citation_doi=10.1016/j.anifeedsci.2022.115430;,citation_journal_title=Animal Feed Science and Technology;">
<meta name="citation_reference" content="citation_title=Complementarity of insect meal and poultry by-product meal as replacement for fishmeal can sustain the production performance of European perch (&amp;amp;amp;lt;i&amp;gt;Perca fluviatilis&amp;lt;/i&amp;gt;), reduce economic fish-in fish-out ratio and food-feed competition, and influence the environmental indices;,citation_author=Hung Q. Tran;,citation_author=Elena Wernicke von Siebenthal;,citation_author=Jean-Baptiste Luce;,citation_author=Tram Nguyen;,citation_author=Aleš Tomčala;,citation_author=Vlastimil Stejskal;,citation_author=Thomas Janssens;,citation_publication_date=2024-01;,citation_cover_date=2024-01;,citation_year=2024;,citation_fulltext_html_url=https://doi.org/10.1016/j.aquaculture.2023.740166;,citation_volume=579;">
<meta name="citation_reference" content="citation_title=Comparative life cycle assessment of heterotrophic microalgae &amp;amp;amp;lt;i&amp;gt;schizochytrium&amp;lt;/i&amp;gt; and fish oil in sustainable aquaculture feeds;,citation_author=Brandi McKuin;,citation_author=Anne R. Kapuscinski;,citation_author=Pallab K. Sarker;,citation_author=Nicolette Cheek;,citation_author=Adele Colwell;,citation_author=Benjamin Schoffstall;,citation_author=Connor Greenwood;,citation_publication_date=2022-01;,citation_cover_date=2022-01;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1525/elementa.2021.00098;,citation_issue=1;,citation_volume=10;">
<meta name="citation_reference" content="citation_title=Defatted black soldier fly (&amp;amp;amp;lt;i&amp;gt;Hermetia illucens&amp;lt;/i&amp;gt;) in pikeperch (<i>Sander lucioperca</i>) diets: Effects on growth performance, nutrient digestibility, fillet quality, economic and environmental sustainability;,citation_author=Vlastimil Stejskal;,citation_author=Hung Q. Tran;,citation_author=Markéta Prokesová;,citation_author=Mahyar Zare;,citation_author=Tatyana Gebauer;,citation_author=Tomas Policar;,citation_author=Christian Caimi;,citation_author=Francesco Gai;,citation_author=Laura Gasco;,citation_publication_date=2022-09;,citation_cover_date=2022-09;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1016/j.aninu.2022.06.022;,citation_journal_title=Animal Nutrition;">
<meta name="citation_reference" content="citation_title=Interventions for improving the productivity and environmental performance of global aquaculture for future food security;,citation_author=Patrik J. G. Henriksson;,citation_author=Max Troell;,citation_author=Lauren Katherine Banks;,citation_author=Ben Belton;,citation_author=Malcolm Beveridge;,citation_author=Dane H. Klinger;,citation_author=Nathan Pelletier;,citation_author=Michael Phillips;,citation_author=Nhuong Tran;,citation_publication_date=2021-09;,citation_cover_date=2021-09;,citation_year=2021;,citation_fulltext_html_url=https://doi.org/10.1016/j.oneear.2021.08.009;,citation_issue=9;,citation_volume=4;,citation_journal_title=One Earth;">
<meta name="citation_reference" content="citation_title=Environmental consequences of using insect meal as an ingredient in aquafeeds: A systematic view;,citation_author=Hung Q. Tran;,citation_author=Hien Van Doan;,citation_author=Vlastimil Stejskal;,citation_publication_date=2021-07;,citation_cover_date=2021-07;,citation_year=2021;,citation_fulltext_html_url=https://doi.org/10.1111/raq.12595;,citation_journal_title=Reviews in Aquaculture;">
<meta name="citation_reference" content="citation_title=Microalgae in aquafeeds for a sustainable aquaculture industry;,citation_author=Mahfuzur Rahman Shah;,citation_author=Giovanni Antonio Lutzu;,citation_author=Asraful Alam;,citation_author=Pallab K. Sarker;,citation_author=M. A. Kabir Chowdhury;,citation_author=Ali Parsaeimehr;,citation_author=Yuanmei Liang;,citation_author=Maurycy Daroch;,citation_publication_date=2018-02;,citation_cover_date=2018-02;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.1007/s10811-017-1234-z;,citation_issue=1;,citation_volume=30;,citation_journal_title=Journal of Applied Phycology;">
<meta name="citation_reference" content="citation_title=The environmental cost of animal source foods;,citation_author=Ray Hilborn;,citation_author=Jeannette A. Banobi;,citation_author=Stephen J. Hall;,citation_author=Teressa Pucylowski;,citation_author=Timothy E. Walsworth;,citation_publication_date=2018-08;,citation_cover_date=2018-08;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.1002/fee.1822;,citation_issue=6;,citation_volume=16;,citation_journal_title=Frontiers in Ecology and the Environment;">
<meta name="citation_reference" content="citation_title=Global fishmeal and fish-oil supply: Inputs, outputs and markets.;,citation_author=Christopher J. Shepherd;,citation_author=A. J. Jackson;,citation_publication_date=2013-10;,citation_cover_date=2013-10;,citation_year=2013;,citation_fulltext_html_url=https://doi.org/10.1111/jfb.12224;,citation_issue=4;,citation_volume=83;,citation_journal_title=Journal of Fish Biology;">
<meta name="citation_reference" content="citation_title=Insect larvae meal as an alternative source of nutrients in the diet of Atlantic salmon (&amp;amp;amp;lt;i&amp;gt;Salmo salar&amp;lt;/i&amp;gt;) postsmolt;,citation_author=Erik-Jan Lock;,citation_author=Tarique Arsiwalla;,citation_author=Rune Waagbø;,citation_publication_date=2016-12;,citation_cover_date=2016-12;,citation_year=2016;,citation_fulltext_html_url=https://doi.org/10.1111/anu.12343;,citation_issue=6;,citation_volume=22;,citation_journal_title=Aquaculture Nutrition;">
<meta name="citation_reference" content="citation_title=Utilisation of feed resources in production of Atlantic salmon (&amp;amp;amp;lt;i&amp;gt;Salmo salar&amp;lt;/i&amp;gt;) in Norway;,citation_author=Trine Ytrestøyl;,citation_author=Turid Synnøve Aas;,citation_author=Torbjørn Åsgård;,citation_publication_date=2015-11;,citation_cover_date=2015-11;,citation_year=2015;,citation_fulltext_html_url=https://doi.org/10.1016/j.aquaculture.2015.06.023;,citation_volume=448;,citation_journal_title=Aquaculture;">
<meta name="citation_reference" content="citation_title=Potential of insect-based diets for Atlantic salmon (&amp;amp;amp;lt;i&amp;gt;Salmo salar&amp;lt;/i&amp;gt;);,citation_author=Ikram Belghit;,citation_author=Nina S. Liland;,citation_author=Rune Waagbø;,citation_author=Irene Biancarosa;,citation_author=Nicole Francesca Pelusio;,citation_author=Yanxian Li;,citation_author=Åshild Krogdahl;,citation_author=Erik-Jan Lock;,citation_publication_date=2018-04;,citation_cover_date=2018-04;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.1016/j.aquaculture.2018.03.016;,citation_volume=491;,citation_journal_title=Aquaculture;">
<meta name="citation_reference" content="citation_title=The sustainability conundrum of fishmeal substitution by plant ingredients in Shrimp Feeds;,citation_author=Wesley Malcorps;,citation_author=Björn Kok;,citation_author=Mike Land;,citation_author=Maarten Fritz;,citation_author=Davy Doren;,citation_author=Kurt Servin;,citation_author=Paul Heijden;,citation_author=Roy Palmer;,citation_author=Neil Alexander Auchterlonie;,citation_author=Max Rietkerk;,citation_author=Maria João Santos;,citation_author=Simon J. Davies;,citation_publication_date=2019-02;,citation_cover_date=2019-02;,citation_year=2019;,citation_fulltext_html_url=https://doi.org/10.3390/su11041212;,citation_issue=4;,citation_doi=10.3390/su11041212;,citation_volume=11;,citation_journal_title=Sustainability;">
<meta name="citation_reference" content="citation_title=Most fish destined for fishmeal production are food-grade fish;,citation_author=Tim Cashion;,citation_author=Frédéric Le Manach;,citation_author=Dirk Zeller;,citation_author=Daniel Pauly;,citation_publication_date=2017-09;,citation_cover_date=2017-09;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.1111/faf.12209;,citation_issue=5;,citation_volume=18;,citation_journal_title=Fish and Fisheries;">
<meta name="citation_reference" content="citation_title=Global overview on the use of fish meal and fish oil in industrially compounded aquafeeds: Trends and future prospects;,citation_author=Albert G. J. Tacon;,citation_author=Marc Metian;,citation_publication_date=2008-12;,citation_cover_date=2008-12;,citation_year=2008;,citation_fulltext_html_url=https://doi.org/10.1016/j.aquaculture.2008.08.015;,citation_issue=1;,citation_volume=285;,citation_journal_title=Aquaculture;">
<meta name="citation_reference" content="citation_title=Environmental impacts of plant-based salmonid diets at feed and farm scales;,citation_author=Joachim Boissy;,citation_author=Joël Aubin;,citation_author=Abdeljalil Drissi;,citation_author=Hayo M. G. Werf;,citation_author=Gordon J. Bell;,citation_author=Sadasivam Kaushik;,citation_publication_date=2011-11;,citation_cover_date=2011-11;,citation_year=2011;,citation_fulltext_html_url=https://doi.org/10.1016/j.aquaculture.2011.08.033;,citation_volume=321;,citation_journal_title=Aquaculture;">
<meta name="citation_reference" content="citation_title=Nutritional Attributes, Substitutability, Scalability, and Environmental Intensity of an Illustrative Subset of Current and Future Protein Sources for Aquaculture Feeds: Joint Consideration of Potential Synergies and Trade-offs;,citation_author=Nathan Pelletier;,citation_author=Dane H. Klinger;,citation_author=Neil A. Sims;,citation_author=Janice Renee Yoshioka;,citation_author=Janice Renee Yoshioka;,citation_author=John N. Kittinger;,citation_publication_date=2018-04;,citation_cover_date=2018-04;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.1021/acs.est.7b05468;,citation_issue=10;,citation_volume=52;,citation_journal_title=Environmental Science &amp;amp;amp; Technology;">
<meta name="citation_reference" content="citation_title=The Future of Aquatic Protein: Implications for Protein Sources in Aquaculture Diets;,citation_author=Katheline Hua;,citation_author=Jennifer M. Cobcroft;,citation_author=Andrew J. Cole;,citation_author=Kelly Condon;,citation_author=Dean R. Jerry;,citation_author=Arnold Mangott;,citation_author=Christina Praeger;,citation_author=Matthew J. Vucko;,citation_author=Chaoshu Zeng;,citation_author=Kyall R. Zenger;,citation_author=Jan M. Strugnell;,citation_publication_date=2019-11;,citation_cover_date=2019-11;,citation_year=2019;,citation_fulltext_html_url=https://doi.org/10.1016/j.oneear.2019.10.018;,citation_issue=3;,citation_volume=1;">
<meta name="citation_reference" content="citation_title=From Cradle to Plate: Analysing the Life Cycle Sustainability of Fish Feed Composition;,citation_author=Beate Zlaugotne;,citation_author=J. Pubule;,citation_publication_date=2024-10;,citation_cover_date=2024-10;,citation_year=2024;,citation_fulltext_html_url=https://doi.org/10.2478/rtuect-2024-0053;,citation_journal_title=Environmental and Climate Technologies;">
<meta name="citation_reference" content="citation_title=Life cycle assessment of aquafeed ingredients;,citation_author=Catarina Basto Silva;,citation_author=Luisa M. P. Valente;,citation_author=Elisabete Matos;,citation_author=Miguel Brandão;,citation_author=Belmira Neto;,citation_publication_date=2018-05;,citation_cover_date=2018-05;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.1007/s11367-017-1414-8;,citation_issue=5;,citation_volume=23;,citation_journal_title=International Journal of Life Cycle Assessment;">
<meta name="citation_reference" content="citation_title=Designing environmentally efficient aquafeeds through the use of multicriteria decision support tools;,citation_author=Ronan Cooney;,citation_author=Alex H. L. Wan;,citation_author=Fearghal O’Donncha;,citation_author=Eoghan Clifford;,citation_publication_date=2021-05;,citation_cover_date=2021-05;,citation_year=2021;,citation_fulltext_html_url=https://doi.org/10.1016/j.coesh.2021.100276;,citation_volume=23;,citation_journal_title=Current Opinion in Environmental Science &amp;amp;amp; Health;">
<meta name="citation_reference" content="citation_title=Understanding and modelling the aquafeed extrusion process for Atlantic salmon feed with an empirical model;,citation_author=Hongyan Cheng;,citation_author=Yiqing Guo;,citation_author=S.J. Højberg;,citation_author=Kyla Meagan Zatti;,citation_author=Aberham Hailu Feyissa;,citation_publication_date=2023-10;,citation_cover_date=2023-10;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1016/j.anifeedsci.2023.115752;,citation_volume=304;,citation_journal_title=Animal Feed Science and Technology;">
<meta name="citation_reference" content="citation_title=Fishmeal partial substitution within aquafeed formulations: Life cycle assessment of four alternative protein sources;,citation_author=Silvia Maiolo;,citation_author=Giuliana Parisi;,citation_author=Natascia Biondi;,citation_author=Fernando Lunelli;,citation_author=Emilio Tibaldi;,citation_author=Roberto Pastres;,citation_publication_date=2020-08;,citation_cover_date=2020-08;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.1007/s11367-020-01759-z;,citation_issue=8;,citation_volume=25;,citation_journal_title=International Journal of Life Cycle Assessment;">
<meta name="citation_reference" content="citation_title=Trends in Global Aquaculture and Aquafeed Production: 2000–2017;,citation_author=Albert G. J. Tacon;,citation_publication_date=2020-01;,citation_cover_date=2020-01;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.1080/23308249.2019.1649634;,citation_issue=1;,citation_volume=28;,citation_journal_title=Reviews in Fisheries Science &amp;amp;amp; Aquaculture;">
<meta name="citation_reference" content="citation_title=Fish as feed: Using economic allocation to quantify the Fish in : Fish out ratio of major fed aquaculture species;,citation_author=Björn Kok;,citation_author=Wesley Malcorps;,citation_author=Michael F. Tlusty;,citation_author=Mahmoud Eltholth;,citation_author=Neil A Auchterlonie;,citation_author=David Little;,citation_author=Robert Harmsen;,citation_author=Richard Newton;,citation_author=Simon J. Davies;,citation_publication_date=2020-11;,citation_cover_date=2020-11;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.1016/j.aquaculture.2020.735474;,citation_volume=528;,citation_journal_title=Aquaculture;">
<meta name="citation_reference" content="citation_title=Avoiding the ecological limits of forage fish for fed aquaculture;,citation_author=Halley E. Froehlich;,citation_author=Nis S. Jacobsen;,citation_author=Timothy E. Essington;,citation_author=Tyler Clavelle;,citation_author=Benjamin S. Halpern;,citation_author=Chelsea M. Williams;,citation_author=Daniel J. Pondella;,citation_author=Douglas Dodds;,citation_author=Andrew J. Plater;,citation_author=Fengfeng Le;,citation_author=Jun Bo;,citation_publication_date=2018-06;,citation_cover_date=2018-06;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.1038/s41893-018-0077-1;,citation_issue=6;,citation_volume=1;">
<meta name="citation_reference" content="citation_title=Fish oil replacement in finfish nutrition;,citation_author=Giovanni M. Turchini;,citation_author=Bente E. Torstensen;,citation_author=Wing-Keong Ng;,citation_publication_date=2009-03;,citation_cover_date=2009-03;,citation_year=2009;,citation_fulltext_html_url=https://doi.org/10.1111/j.1753-5131.2008.01001.x;,citation_issue=1;,citation_volume=1;,citation_journal_title=Reviews in Aquaculture;">
<meta name="citation_reference" content="citation_title=Does aquaculture add resilience to the global food system;,citation_author=Max Troell;,citation_author=Rosamond L. Naylor;,citation_author=Marc Métian;,citation_author=Malcolm C. M. Beveridge;,citation_author=Peter Tyedmers;,citation_author=Carl Folke;,citation_author=Kenneth J. Arrow;,citation_author=Scott Barrett;,citation_author=Anne-Sophie Crépin;,citation_author=Paul R. Ehrlich;,citation_author=Åsa Gren;,citation_author=Nils Kautsky;,citation_author=Simon A. Levin;,citation_author=Karine Nyborg;,citation_author=Henrik Österblom;,citation_author=Stephen Polasky;,citation_author=Marten Scheffer;,citation_author=Brian Walker;,citation_author=Tasos Xepapadeas;,citation_author=Aart Zeeuw;,citation_publication_date=2014-09;,citation_cover_date=2014-09;,citation_year=2014;,citation_fulltext_html_url=https://doi.org/10.1073/pnas.1404067111;,citation_issue=37;,citation_volume=111;,citation_journal_title=Proceedings of the National Academy of Sciences of the United States of America;">
<meta name="citation_reference" content="citation_title=Direct and indirect effects of climate and fishing on changes in coastal ecosystem services: A historical perspective from the North Sea;,citation_author=Samiya A. Selim;,citation_author=Julia L. Blanchard;,citation_author=Jacob Bedford;,citation_author=Thomas J. Webb;,citation_publication_date=2016-02;,citation_cover_date=2016-02;,citation_year=2016;,citation_fulltext_html_url=https://doi.org/10.1007/s10113-014-0635-7;,citation_issue=2;,citation_volume=16;,citation_journal_title=Regional Environmental Change;">
<meta name="citation_reference" content="citation_title=Global adoption of novel aquaculture feeds could substantially reduce forage fish demand by 2030;,citation_author=Richard S. Cottrell;,citation_author=Julia L. Blanchard;,citation_author=Benjamin S. Halpern;,citation_author=Marc Metian;,citation_author=Halley E. Froehlich;,citation_publication_date=2020-05;,citation_cover_date=2020-05;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.1038/s43016-020-0078-x;,citation_issue=5;,citation_doi=10.1038/s43016-020-0078-x;,citation_volume=1;,citation_journal_title=Nature Food;">
<meta name="citation_reference" content="citation_title=Linked sustainability challenges and trade-offs among fisheries, aquaculture and agriculture.;,citation_author=Julia L. Blanchard;,citation_author=Reg Watson;,citation_author=Elizabeth A. Fulton;,citation_author=Richard S. Cottrell;,citation_author=Kirsty L. Nash;,citation_author=Andrea Bryndum-Buchholz;,citation_author=Matthias Büchner;,citation_author=David A. Carozza;,citation_author=William W. L. Cheung;,citation_author=Joshua Elliott;,citation_author=Lindsay Davidson;,citation_author=Nicholas K. Dulvy;,citation_author=John P. Dunne;,citation_author=Tyler D. Eddy;,citation_author=Eric D. Galbraith;,citation_author=Heike K. Lotze;,citation_author=Olivier Maury;,citation_author=Christoph Müller;,citation_author=Derek P. Tittensor;,citation_author=Simon Jennings;,citation_publication_date=2017-08;,citation_cover_date=2017-08;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.1038/s41559-017-0258-8;,citation_issue=9;,citation_volume=1;,citation_journal_title=Nature Ecology and Evolution;">
<meta name="citation_reference" content="citation_title=Modelling the effects of ration on individual growth of &amp;amp;amp;lt;i&amp;gt;Oncorhynchus tshawytscha&amp;lt;/i&amp;gt; under controlled conditions;,citation_author=Alexandra Johne;,citation_author=Chris Carter;,citation_author=Simon Wotherspoon;,citation_author=Scott Hadley;,citation_author=Jane E. Symonds;,citation_author=Seumas P. Walker;,citation_author=Julia L. Blanchard;,citation_publication_date=2023-07;,citation_cover_date=2023-07;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1111/jfb.15499;,citation_issue=5;,citation_volume=103;,citation_journal_title=Journal of Fish Biology;">
<meta name="citation_reference" content="citation_title=Environmental footprints of farmed chicken and salmon bridge the land and sea;,citation_author=Caitlin D. Kuempel;,citation_author=Melanie Frazier;,citation_author=Juliette Verstaen;,citation_author=Paul-Eric Rayner;,citation_author=Julia L. Blanchard;,citation_author=Richard S. Cottrell;,citation_author=Halley E. Froehlich;,citation_author=Jessica A. Gephart;,citation_author=Nis S. Jacobsen;,citation_author=Peter B. McIntyre;,citation_author=Marc Métian;,citation_author=Daniel Moran;,citation_author=Kirsty L. Nash;,citation_author=Johannes Többen;,citation_author=David Williams;,citation_author=Benjamin S. Halpern;,citation_publication_date=2023-03;,citation_cover_date=2023-03;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1016/j.cub.2023.01.037;,citation_issue=5;,citation_volume=33;,citation_journal_title=Current Biology;">
<meta name="citation_reference" content="citation_title=Vulnerability of blue foods to human-induced environmental change;,citation_author=Ling Cao;,citation_author=Benjamin S. Halpern;,citation_author=Max Troell;,citation_author=Richard L. Short;,citation_author=Cong Zeng;,citation_author=Ziyu Jiang;,citation_author=Y. Liu;,citation_author=Chengxuan Zou;,citation_author=Chunyu Liu;,citation_author=Shurong Liu;,citation_author=Xiangwei Liu;,citation_author=William W. L. Cheung;,citation_author=Richard S. Cottrell;,citation_author=Fabrice DeClerck;,citation_author=Stefan Gelcich;,citation_author=Jessica A. Gephart;,citation_author=Dakoury Godo-Solo;,citation_author=Jessie Ihilani Kaull;,citation_author=Fiorenza Micheli;,citation_author=Rosamond L. Naylor;,citation_author=Hanna J. Payne;,citation_author=Elizabeth R. Selig;,citation_author=U. Rashid Sumaila;,citation_author=Michelle Tigchelaar;,citation_publication_date=2023-06;,citation_cover_date=2023-06;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1038/s41893-023-01156-y;,citation_issue=10;,citation_volume=6;,citation_journal_title=Nature Sustainability;">
<meta name="citation_reference" content="citation_title=An R package for simulating growth and organic wastage in aquaculture farms in response to environmental conditions and husbandry practices;,citation_author=Damiano Baldan;,citation_author=Erika M. D. Porporato;,citation_author=Roberto Pastres;,citation_author=Daniele Brigolin;,citation_publication_date=2018-05;,citation_cover_date=2018-05;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.1371/journal.pone.0195732;,citation_issue=5;,citation_issn=1932-6203;,citation_volume=13;,citation_journal_title=PLOS ONE;">
<meta name="citation_reference" content="citation_title=The origins of ingredients matter more than ingredient types for the environmental footprint of aquaculture feeds;,citation_author=Richard S. Cottrell;,citation_author=Benjamin S. Halpern;,citation_author=Marceau Cormery;,citation_author=Helen A. Hamilton;,citation_author=Gage Clawson;,citation_author=Beth Penrose;,citation_author=Louise Adams;,citation_author=John P. Bowman;,citation_author=Duncan D. Cameron;,citation_author=Chris G. Carter;,citation_author=Tom Fox-Smith;,citation_author=Scott Hadley;,citation_author=Alexandra Johne;,citation_author=Catriona Macleod;,citation_author=Sowdamini Sesha Prasad;,citation_author=Xintong Qiu;,citation_author=Camille A. White;,citation_author=Xin Zhan;,citation_author=Julia L. Blanchard;">
<meta name="citation_reference" content="citation_title=Multi-scale integrated evaluation of the sustainability of large-scale use of alternative feeds in salmon aquaculture;,citation_author=Juan J. Cadillo-Benalcazar;,citation_author=Mario Giampietro;,citation_author=Sandra G. F. Bukkens;,citation_author=Roger Strand;,citation_publication_date=2020-03;,citation_cover_date=2020-03;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.1016/j.jclepro.2019.119210;,citation_issn=0959-6526;,citation_volume=248;,citation_journal_title=Journal of Cleaner Production;">
<meta name="citation_reference" content="citation_title=Continued Transitions from Fish Meal and Oil in Aquafeeds Require Close Attention to Biodiversity Trade-Offs;,citation_author=Gage Clawson;,citation_author=Julia L. Blanchard;,citation_author=Marceau Cormery;,citation_author=Beth Fulton;,citation_author=Benjamin S. Halpern;,citation_author=Helen A. Hamilton;,citation_author=Casey C. O’Hara;,citation_author=Richard S. Cottrell;,citation_publication_date=2024-11;,citation_cover_date=2024-11;,citation_year=2024;,citation_fulltext_html_url=https://doi.org/10.2139/ssrn.5030822;,citation_publisher=Social Science Research Network;">
<meta name="citation_reference" content="citation_title=Perspectives on aquaculture’s contribution to the Sustainable Development Goals for improved human and planetary health;,citation_author=Max Troell;,citation_author=Barry Costa-Pierce;,citation_author=Selina Stead;,citation_author=Richard S. Cottrell;,citation_author=Cecile Brugere;,citation_author=Anna K. Farmery;,citation_author=David C. Little;,citation_author=Åsa Strand;,citation_author=Roger Pullin;,citation_author=Doris Soto;,citation_author=Malcolm Beveridge;,citation_author=Khalid Salie;,citation_author=Jorge Dresdner;,citation_author=Patricia Moraes-Valenti;,citation_author=Julia Blanchard;,citation_author=Philip James;,citation_author=Rodrigue Yossa;,citation_author=Edward Allison;,citation_author=Christopher Devaney;,citation_author=Uwe Barg;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1111/jwas.12946;,citation_issue=2;,citation_issn=1749-7345;,citation_volume=54;,citation_journal_title=Journal of the World Aquaculture Society;">
<meta name="citation_reference" content="citation_title=San Pedro Shelf California: Testing the Pearson-Rosenberg model (PRM);,citation_author=Don Maurer;,citation_author=George Robertson;,citation_author=Thomas Gerlinger;,citation_publication_date=1993-01;,citation_cover_date=1993-01;,citation_year=1993;,citation_fulltext_html_url=https://doi.org/10.1016/0141-1136(93)90099-L;,citation_issue=4;,citation_issn=0141-1136;,citation_volume=35;,citation_journal_title=Marine Environmental Research;">
<meta name="citation_reference" content="citation_title=Macrobenthos community succession in the northern Gulf of Mexico hypoxic regions: Testing the Pearson-Rosenberg model;,citation_author=Shivakumar Shivarudrappa;,citation_author=Kevin Briggs;,citation_publication_date=2017-01;,citation_cover_date=2017-01;,citation_year=2017;,citation_fulltext_html_url=https://elischolar.library.yale.edu/journal_of_marine_research/425;,citation_issue=1;,citation_volume=75;,citation_journal_title=Journal of Marine Research;">
<meta name="citation_reference" content="citation_title=Animal-sediment relationships: Evaluating the “Pearson–Rosenberg paradigm” in Mediterranean coastal lagoons;,citation_author=Paolo Magni;,citation_author=Davide Tagliapietra;,citation_author=Claudio Lardicci;,citation_author=Len Balthis;,citation_author=Alberto Castelli;,citation_author=Serena Como;,citation_author=Gretel Frangipane;,citation_author=Gianmarco Giordani;,citation_author=Jeffrey L. Hyland;,citation_author=Ferruccio Maltagliati;,citation_author=Giuseppe Pessa;,citation_author=Andrea F. Rismondo;,citation_author=Mariella Tataranni;,citation_author=Paolo Tomassetti;,citation_author=Pierluigi Viaroli;,citation_publication_date=2009-04;,citation_cover_date=2009-04;,citation_year=2009;,citation_fulltext_html_url=https://doi.org/10.1016/j.marpolbul.2008.12.009;,citation_issue=4;,citation_issn=0025-326X;,citation_volume=58;,citation_journal_title=Marine Pollution Bulletin;">
<meta name="citation_reference" content="citation_title=Efficiency of feed utilization in Atlantic salmon (&amp;amp;amp;lt;i&amp;gt;Salmo salar&amp;lt;/i&amp;gt; L.) fed diets with increasing substitution of fish meal with vegetable proteins;,citation_author=Johannes Opstvedt;,citation_author=Anders Aksnes;,citation_author=Britt Hope;,citation_author=Ian H. Pike;,citation_publication_date=2003-05;,citation_cover_date=2003-05;,citation_year=2003;,citation_fulltext_html_url=https://doi.org/10.1016/S0044-8486(03)00026-7;,citation_issue=1-4;,citation_issn=00448486;,citation_volume=221;,citation_journal_title=Aquaculture;">
<meta name="citation_reference" content="citation_title=Global change in marine aquaculture production potential under climate change;,citation_author=Halley E. Froehlich;,citation_author=Rebecca R. Gentry;,citation_author=Benjamin S. Halpern;,citation_publication_date=2018-11;,citation_cover_date=2018-11;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.1038/s41559-018-0669-1;,citation_issue=11;,citation_issn=2397-334X;,citation_volume=2;,citation_journal_title=Nature Ecology &amp;amp;amp; Evolution;">
<meta name="citation_reference" content="citation_title=Mapping the global potential for marine aquaculture;,citation_author=Rebecca R. Gentry;,citation_author=Halley E. Froehlich;,citation_author=Dietmar Grimm;,citation_author=Peter Kareiva;,citation_author=Michael Parke;,citation_author=Michael Rust;,citation_author=Steven D. Gaines;,citation_author=Benjamin S. Halpern;,citation_publication_date=2017-09;,citation_cover_date=2017-09;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.1038/s41559-017-0257-9;,citation_issue=9;,citation_issn=2397-334X;,citation_volume=1;,citation_journal_title=Nature Ecology &amp;amp;amp; Evolution;">
<meta name="citation_reference" content="citation_title=Estimating stocking weights for Atlantic salmon to grow to market size at novel aquaculture sites with extreme temperatures;,citation_author=Danielle P. Dempsey;,citation_author=Gregor K. Reid;,citation_author=Leah Lewis-McCrea;,citation_author=Toby Balch;,citation_author=Roland Cusack;,citation_author=André Dumas;,citation_author=Jack Rensel;,citation_publication_date=2023-05;,citation_cover_date=2023-05;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.3389/fmars.2023.1094247;,citation_issn=2296-7745;,citation_volume=10;,citation_journal_title=Frontiers in Marine Science;">
<meta name="citation_reference" content="citation_title=Towards better survival: Modeling drivers for daily mortality in Norwegian Atlantic salmon farming;,citation_author=Ingunn Fride Tvete;,citation_author=Magne Aldrin;,citation_author=Britt Bang Jensen;,citation_publication_date=2023-01;,citation_cover_date=2023-01;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1016/j.prevetmed.2022.105798;,citation_issn=0167-5877;,citation_volume=210;,citation_journal_title=Preventive Veterinary Medicine;">
<meta name="citation_reference" content="citation_title=Modelling Compensatory Growth;,citation_author=Niall. Broekhuizen;,citation_author=William. S. C. Gurney;,citation_author=A. Jones;,citation_author=A. D. Bryant;,citation_publication_date=1994;,citation_cover_date=1994;,citation_year=1994;,citation_fulltext_html_url=https://doi.org/10.2307/2390237;,citation_issue=6;,citation_issn=0269-8463;,citation_volume=8;,citation_journal_title=Functional Ecology;">
<meta name="citation_reference" content="citation_title=Energy equivalents of oxygen consumption in animal energetics;,citation_author=J. M. Elliott;,citation_author=W. Davison;,citation_publication_date=1975-09;,citation_cover_date=1975-09;,citation_year=1975;,citation_fulltext_html_url=https://doi.org/10.1007/BF00345305;,citation_issue=3;,citation_issn=1432-1939;,citation_volume=19;,citation_journal_title=Oecologia;">
<meta name="citation_reference" content="citation_title=Using meta-analysis to derive a respiration model for Atlantic salmon (&amp;amp;amp;lt;i&amp;gt;Salmo salar&amp;lt;/i&amp;gt;) to assess bioenergetics requirements of juveniles in two Canadian rivers;,citation_author=Camille J. Macnaughton;,citation_author=David Deslauriers;,citation_author=Erinn L. Ipsen;,citation_author=Emily Corey;,citation_author=Eva C. Enders;,citation_publication_date=2019-12;,citation_cover_date=2019-12;,citation_year=2019;,citation_fulltext_html_url=https://doi.org/10.1139/cjfas-2018-0436;,citation_issue=12;,citation_issn=0706-652X;,citation_volume=76;,citation_journal_title=Canadian Journal of Fisheries and Aquatic Sciences;">
<meta name="citation_reference" content="citation_title=Thermal performance of juvenile Atlantic Salmon, &amp;amp;amp;lt;i&amp;gt;Salmo salar&amp;lt;/i&amp;gt; L.;,citation_author=Bror Jonsson;,citation_author=Torbjørn Forseth;,citation_author=Arne. J. Jensen;,citation_author=Tor. F. Næsje;,citation_publication_date=2001;,citation_cover_date=2001;,citation_year=2001;,citation_fulltext_html_url=https://doi.org/10.1046/j.0269-8463.2001.00572.x;,citation_issue=6;,citation_issn=1365-2435;,citation_volume=15;,citation_journal_title=Functional Ecology;">
<meta name="citation_reference" content="citation_title=Unusual aerobic performance at high temperatures in juvenile Chinook salmon, &amp;amp;amp;lt;i&amp;gt;Oncorhynchus tshawytscha&amp;lt;/i&amp;gt;;,citation_author=Jamilynn B. Poletto;,citation_author=Dennis E. Cocherell;,citation_author=Sarah E. Baird;,citation_author=Trinh X. Nguyen;,citation_author=Valentina Cabrera-Stagno;,citation_author=Anthony P. Farrell;,citation_author=Nann A. Fangue;,citation_publication_date=2017-01;,citation_cover_date=2017-01;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.1093/conphys/cow067;,citation_issue=1;,citation_issn=2051-1434;,citation_volume=5;,citation_journal_title=Conservation Physiology;">
<meta name="citation_reference" content="citation_title=Lowering temperature to 1&nbsp;°C results in physiological changes, stress and mortality in cultured Atlantic Salmon (&amp;amp;amp;lt;i&amp;gt;Salmo salar&amp;lt;/i&amp;gt;);,citation_author=Émile Vadboncoeur;,citation_author=Charlotte Nelson;,citation_author=Jennifer R. Hall;,citation_author=Kathy A. Clow;,citation_author=Rebeccah M. Sandrelli;,citation_author=Colin J. Brauner;,citation_author=Andrew K. Swanson;,citation_author=A. Kurt Gamperl;,citation_publication_date=2023-04;,citation_cover_date=2023-04;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1016/j.aquaculture.2023.739313;,citation_issn=0044-8486;,citation_volume=568;,citation_journal_title=Aquaculture;">
<meta name="citation_reference" content="citation_title=Development of a nutritional model to define the energy and protein requirements of cobia, &amp;amp;amp;lt;i&amp;gt;Rachycentron canadum&amp;lt;/i&amp;gt;;,citation_author=Nguyen Van Tien;,citation_author=Dam T. M. Chinh;,citation_author=Tran T. M. Huong;,citation_author=Truong H. Phuong;,citation_author=Simon Irvin;,citation_author=Brett Glencross;,citation_publication_date=2016-10;,citation_cover_date=2016-10;,citation_year=2016;,citation_fulltext_html_url=https://doi.org/10.1016/j.aquaculture.2016.05.037;,citation_issn=0044-8486;,citation_volume=463;,citation_journal_title=Aquaculture;">
<meta name="citation_reference" content="citation_title=The effect of temperature and fish size on growth, feed intake, food conversion efficiency and stomach evacuation rate of Atlantic salmon post-smolts;,citation_author=Sigurd O. Handeland;,citation_author=Albert K. Imsland;,citation_author=Sigurd O. Stefansson;,citation_publication_date=2008-10;,citation_cover_date=2008-10;,citation_year=2008;,citation_fulltext_html_url=https://doi.org/10.1016/j.aquaculture.2008.06.042;,citation_issue=1;,citation_issn=0044-8486;,citation_volume=283;,citation_journal_title=Aquaculture;">
<meta name="citation_reference" content="citation_title=Energy allocation among developmental stages, age groups, and types of Atlantic salmon (&amp;amp;amp;lt;i&amp;gt;Salmo salar&amp;lt;/i&amp;gt;) spawners;,citation_author=Nina Jonsson;,citation_author=Bror Jonsson;,citation_publication_date=2003-05;,citation_cover_date=2003-05;,citation_year=2003;,citation_fulltext_html_url=https://doi.org/10.1139/f03-042;,citation_issue=5;,citation_issn=0706-652X;,citation_volume=60;,citation_journal_title=Canadian Journal of Fisheries and Aquatic Sciences;">
<meta name="citation_reference" content="citation_title=Does waste feed from salmon farming affect the quality of saithe (&amp;amp;amp;lt;i&amp;gt;Pollachius virens&amp;lt;/i&amp;gt; L.) attracted to fish farms?;,citation_author=Ingebrigt Uglem;,citation_author=Kilian Toledo-Guedes;,citation_author=Pablo Sanchez-Jerez;,citation_author=Eva M. Ulvan;,citation_author=Tor Evensen;,citation_author=Bjørn S. Sæther;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.1111/are.14519;,citation_issue=4;,citation_issn=1365-2109;,citation_volume=51;,citation_journal_title=Aquaculture Research;">
<meta name="citation_reference" content="citation_title=Feed Ingredients for Sustainable Aquaculture;,citation_author=Ewen McLean;,citation_editor=Pasquale Ferranti;,citation_publication_date=2023-01;,citation_cover_date=2023-01;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.1016/b978-0-12-823960-5.00085-8;,citation_isbn=978-0-12-824166-0;,citation_inbook_title=Sustainable Food Science - A Comprehensive Approach;">
<meta name="citation_reference" content="citation_title=Climate change risks to marine ecosystems and fisheries: Projections to 2100 from the Fisheries and Marine Ecosystem Model Intercomparison Project;,citation_author=Julia L. Blanchard;,citation_author=Camilla Novaglio;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://doi.org/10.4060/cd1379en;,citation_technical_report_institution=FAO;,citation_technical_report_number=707;">
<meta name="citation_reference" content="citation_title=R: A language and environment for statistical computing;,citation_author=R Core Team;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://www.R-project.org;">
<meta name="citation_reference" content="citation_title=Quarto;,citation_author=J. J. Allaire;,citation_author=Charles Teague;,citation_author=Carlos Scheidegger;,citation_author=Yihui Xie;,citation_author=Christophe Dervieux;,citation_publication_date=2024-02;,citation_cover_date=2024-02;,citation_year=2024;,citation_fulltext_html_url=https://github.com/quarto-dev/quarto-cli;,citation_doi=10.5281/zenodo.5960048;">
<meta name="citation_reference" content="citation_title=acronyms;,citation_author=Remy Chaput;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://github.com/rchaput/acronyms;">
<meta name="citation_reference" content="citation_title=Tinytex: Helper functions to install and maintain TeX live, and compile LaTeX documents;,citation_author=Yihui Xie;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_fulltext_html_url=https://cran.r-project.org/web/packages/tinytex;">
<meta name="citation_reference" content="citation_title=Ecoflux: Functions for ecological flux studies including sap flux and soil/stem c efflux.;,citation_author=Joe Shannon;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;">
<meta name="citation_reference" content="citation_title=The targets r package: A dynamic make-like function-oriented pipeline toolkit for reproducibility and high-performance computing;,citation_author=William Michael Landau;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://doi.org/10.21105/joss.02959;,citation_issue=57;,citation_volume=6;,citation_journal_title=Journal of Open Source Software;">
<meta name="citation_reference" content="citation_title=Welcome to the tidyverse;,citation_author=Hadley Wickham;,citation_author=Mara Averick;,citation_author=Jennifer Bryan;,citation_author=Winston Chang;,citation_author=Lucy D’Agostino McGowan;,citation_author=Romain François;,citation_author=Garrett Grolemund;,citation_author=Alex Hayes;,citation_author=Lionel Henry;,citation_author=Jim Hester;,citation_author=Max Kuhn;,citation_author=Thomas Lin Pedersen;,citation_author=Evan Miller;,citation_author=Stephan Milton Bache;,citation_author=Kirill Müller;,citation_author=Jeroen Ooms;,citation_author=David Robinson;,citation_author=Dana Paige Seidel;,citation_author=Vitalie Spinu;,citation_author=Kohske Takahashi;,citation_author=Davis Vaughan;,citation_author=Claus Wilke;,citation_author=Kara Woo;,citation_author=Hiroaki Yutani;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=43;,citation_doi=10.21105/joss.01686;,citation_volume=4;,citation_journal_title=Journal of Open Source Software;">
<meta name="citation_reference" content="citation_title=Renv: Project environments;,citation_author=Kevin Ushey;,citation_author=Hadley Wickham;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://rstudio.github.io/renv/;">
<meta name="citation_reference" content="citation_title=Broom: Convert statistical objects into tidy tibbles;,citation_author=David Robinson;,citation_author=Alex Hayes;,citation_author=Simon Couch;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=broom;">
<meta name="citation_reference" content="citation_title=Cli: Helpers for developing command line interfaces;,citation_author=Gábor Csárdi;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=cli;">
<meta name="citation_reference" content="citation_title=Conflicted: An alternative conflict resolution strategy;,citation_author=Hadley Wickham;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=conflicted;">
<meta name="citation_reference" content="citation_title=Cowplot: Streamlined plot theme and plot annotations for ’ggplot2’;,citation_author=Claus O. Wilke;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=cowplot;">
<meta name="citation_reference" content="citation_title=Dbplyr: A ’dplyr’ back end for databases;,citation_author=Hadley Wickham;,citation_author=Maximilian Girlich;,citation_author=Edgar Ruiz;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=dbplyr;">
<meta name="citation_reference" content="citation_title=Dplyr: A grammar of data manipulation;,citation_author=Hadley Wickham;,citation_author=Romain François;,citation_author=Lionel Henry;,citation_author=Kirill Müller;,citation_author=Davis Vaughan;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=dplyr;">
<meta name="citation_reference" content="citation_title=Dtplyr: Data table back-end for ’dplyr’;,citation_author=Hadley Wickham;,citation_author=Maximilian Girlich;,citation_author=Mark Fairbanks;,citation_author=Ryan Dickerson;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=dtplyr;">
<meta name="citation_reference" content="citation_title=Forcats: Tools for working with categorical variables (factors);,citation_author=Hadley Wickham;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=forcats;">
<meta name="citation_reference" content="citation_title=Formatdown: Formatting numbers in ’rmarkdown’ documents;,citation_author=Richard Layton;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=formatdown;">
<meta name="citation_reference" content="citation_title=ggplot2: Elegant graphics for data analysis;,citation_author=Hadley Wickham;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_fulltext_html_url=https://ggplot2.tidyverse.org;,citation_isbn=978-3-319-24277-4;">
<meta name="citation_reference" content="citation_title=Googledrive: An interface to google drive;,citation_author=Lucy D’Agostino McGowan;,citation_author=Jennifer Bryan;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=googledrive;">
<meta name="citation_reference" content="citation_title=googlesheets4: Access google sheets using the sheets API V4;,citation_author=Jennifer Bryan;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=googlesheets4;">
<meta name="citation_reference" content="citation_title=Haven: Import and export ’SPSS’, ’stata’ and ’SAS’ files;,citation_author=Hadley Wickham;,citation_author=Evan Miller;,citation_author=Danny Smith;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=haven;">
<meta name="citation_reference" content="citation_title=Hms: Pretty time of day;,citation_author=Kirill Müller;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=hms;">
<meta name="citation_reference" content="citation_title=Httr: Tools for working with URLs and HTTP;,citation_author=Hadley Wickham;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=httr;">
<meta name="citation_reference" content="citation_title=The jsonlite package: A practical and consistent mapping between JSON data and r objects;,citation_author=Jeroen Ooms;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_fulltext_html_url=https://arxiv.org/abs/1403.2805;,citation_journal_title=arXiv:1403.2805 [stat.CO];">
<meta name="citation_reference" content="citation_title=Dates and times made easy with lubridate;,citation_author=Garrett Grolemund;,citation_author=Hadley Wickham;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_fulltext_html_url=https://www.jstatsoft.org/v40/i03/;,citation_issue=3;,citation_volume=40;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Magrittr: A forward-pipe operator for r;,citation_author=Stefan Milton Bache;,citation_author=Hadley Wickham;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://CRAN.R-project.org/package=magrittr;">
<meta name="citation_reference" content="citation_title=Modelr: Modelling functions that work with the pipe;,citation_author=Hadley Wickham;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=modelr;">
<meta name="citation_reference" content="citation_title=Ozmaps: Australia maps;,citation_author=Michael Sumner;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://github.com/mdsumner/ozmaps;">
<meta name="citation_reference" content="citation_title=Pillar: Coloured formatting for columns;,citation_author=Kirill Müller;,citation_author=Hadley Wickham;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=pillar;">
<meta name="citation_reference" content="citation_title=Purrr: Functional programming tools;,citation_author=Hadley Wickham;,citation_author=Lionel Henry;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=purrr;">
<meta name="citation_reference" content="citation_title=Ragg: Graphic devices based on AGG;,citation_author=Thomas Lin Pedersen;,citation_author=Maxim Shemanarev;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=ragg;">
<meta name="citation_reference" content="citation_title=Readr: Read rectangular text data;,citation_author=Hadley Wickham;,citation_author=Jim Hester;,citation_author=Jennifer Bryan;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=readr;">
<meta name="citation_reference" content="citation_title=Readxl: Read excel files;,citation_author=Hadley Wickham;,citation_author=Jennifer Bryan;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=readxl;">
<meta name="citation_reference" content="citation_title=Reprex: Prepare reproducible example code via the clipboard;,citation_author=Jennifer Bryan;,citation_author=Jim Hester;,citation_author=David Robinson;,citation_author=Hadley Wickham;,citation_author=Christophe Dervieux;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=reprex;">
<meta name="citation_reference" content="citation_title=Rlang: Functions for base types and core r and ’tidyverse’ features;,citation_author=Lionel Henry;,citation_author=Hadley Wickham;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=rlang;">
<meta name="citation_reference" content="citation_title=Rstudioapi: Safely access the RStudio API;,citation_author=Kevin Ushey;,citation_author=JJ Allaire;,citation_author=Hadley Wickham;,citation_author=Gary Ritchie;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=rstudioapi;">
<meta name="citation_reference" content="citation_title=Rvest: Easily harvest (scrape) web pages;,citation_author=Hadley Wickham;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=rvest;">
<meta name="citation_reference" content="citation_title=Simple features for r: Standardized support for spatial vector data;,citation_author=Edzer Pebesma;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=https://doi.org/10.32614/RJ-2018-009;,citation_issue=1;,citation_volume=10;,citation_journal_title=The R Journal;">
<meta name="citation_reference" content="citation_title=Stringr: Simple, consistent wrappers for common string operations;,citation_author=Hadley Wickham;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=stringr;">
<meta name="citation_reference" content="citation_title=Terra: Spatial data analysis;,citation_author=Robert J. Hijmans;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=terra;">
<meta name="citation_reference" content="citation_title=Tibble: Simple data frames;,citation_author=Kirill Müller;,citation_author=Hadley Wickham;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=tibble;">
<meta name="citation_reference" content="citation_title=Tidyr: Tidy messy data;,citation_author=Hadley Wickham;,citation_author=Davis Vaughan;,citation_author=Maximilian Girlich;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=tidyr;">
<meta name="citation_reference" content="citation_title=Welcome to the tidyverse;,citation_author=Hadley Wickham;,citation_author=Mara Averick;,citation_author=Jennifer Bryan;,citation_author=Winston Chang;,citation_author=Lucy D’Agostino McGowan;,citation_author=Romain François;,citation_author=Garrett Grolemund;,citation_author=Alex Hayes;,citation_author=Lionel Henry;,citation_author=Jim Hester;,citation_author=Max Kuhn;,citation_author=Thomas Lin Pedersen;,citation_author=Evan Miller;,citation_author=Stephan Milton Bache;,citation_author=Kirill Müller;,citation_author=Jeroen Ooms;,citation_author=David Robinson;,citation_author=Dana Paige Seidel;,citation_author=Vitalie Spinu;,citation_author=Kohske Takahashi;,citation_author=Davis Vaughan;,citation_author=Claus Wilke;,citation_author=Kara Woo;,citation_author=Hiroaki Yutani;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=43;,citation_doi=10.21105/joss.01686;,citation_volume=4;,citation_journal_title=Journal of Open Source Software;">
<meta name="citation_reference" content="citation_title=Measurement units in R;,citation_author=Edzer Pebesma;,citation_author=Thomas Mailund;,citation_author=James Hiebert;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_issue=2;,citation_doi=10.32614/RJ-2016-061;,citation_volume=8;,citation_journal_title=R Journal;">
<meta name="citation_reference" content="citation_title=xml2: Parse XML;,citation_author=Hadley Wickham;,citation_author=Jim Hester;,citation_author=Jeroen Ooms;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://CRAN.R-project.org/package=xml2;">
<meta name="citation_reference" content="citation_title=BARRA2: Development of the next-generation australian regional atmospheric reanalysis;,citation_author=Chun-Hsu Su;,citation_author=Susan Rennie;,citation_author=Imtiaz Dharssi;,citation_author=J. Torrance;,citation_author=A. Smith;,citation_author=T. Le;,citation_author=Peter Steinle;,citation_author=C. Stassen;,citation_author=R. A. Warren;,citation_author=C. Wang;,citation_author=J. Le Marshall;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=http://www.bom.gov.au/research/publications/researchreports/BRR-067.pdf;,citation_journal_title=Geoscientific Model Development (Bureau Research Report 067);">
<meta name="citation_reference" content="citation_title=Bureau of meteorology atmospheric high-resolution regional reanalysis for australia - version 2 (BARRA2);,citation_author=Bureau of Meteorology (BOM);,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.25914/1X6G-2V48;">
<meta name="citation_reference" content="citation_title=AusBathyTopo (australia) 250m 2023 - a high-resolution depth model (20230004C);,citation_author=Robin J. Beaman;,citation_publication_date=2023;,citation_cover_date=2023;,citation_year=2023;,citation_fulltext_html_url=https://doi.org/10.26186/148758;,citation_inbook_title=undefined;">
<meta name="citation_reference" content="citation_title=Towards a dynamically balanced eddy-resolving ocean reanalysis: BRAN3;,citation_author=Peter R. Oke;,citation_author=Pavel Sakov;,citation_author=Madeleine L. Cahill;,citation_author=Jeff R. Dunn;,citation_author=Russell Fiedler;,citation_author=David A. Griffin;,citation_author=Jim V. Mansbridge;,citation_author=Ken R. Ridgway;,citation_author=Andreas Schiller;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=https://doi.org/10.1016/j.ocemod.2013.03.008;,citation_volume=67;,citation_journal_title=Ocean Modelling;">
<meta name="citation_reference" content="citation_title=The bluelink ocean data assimilation system (BODAS);,citation_author=Peter R. Oke;,citation_author=Gary B. Brassington;,citation_author=David A. Griffin;,citation_author=Andreas Schiller;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_fulltext_html_url=https://doi.org/10.1016/j.ocemod.2007.11.002;,citation_volume=21;,citation_journal_title=Ocean Modelling;">
<meta name="citation_reference" content="citation_title=Next generation of bluelink ocean reanalysis with multiscale data assimilation: BRAN2020;,citation_author=Matthew A. Chamberlain;,citation_author=Peter R. Oke;,citation_author=Russell A. S. Fiedler;,citation_author=Helen M. Beggs;,citation_author=Gary B. Brassington;,citation_author=Prasanth Divakaran;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://doi.org/10.5194/essd-13-5663-2021;,citation_volume=13;,citation_journal_title=Earth System Science Data;">
<meta name="citation_reference" content="citation_title=IMOS - combined biogeochemical parameters (reference stations);,citation_author=Integrated Marine Observing System (IMOS);,citation_author=CSIRO Oceans and Atmosphere;,citation_author=Australian Institute of Marine Science (AIMS);,citation_author=Department of Planning and Environment (DPE), New South Wales Government;,citation_author=South Australian Research and Development Institute (SARDI);,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://catalogue-imos.aodn.org.au/geonetwork/srv/eng/catalog.search#/metadata/b442c3e8-3d30-48ad-b144-680afd848167;">
<meta name="citation_reference" content="citation_title=Xarray: v0.8.0;,citation_author=Stephan Hoyer;,citation_author=Clark Fitzgerald;,citation_author=Joe Hamman;,citation_author=others;,citation_publication_date=2016-08;,citation_cover_date=2016-08;,citation_year=2016;,citation_fulltext_html_url=https://doi.org/10.5281/zenodo.59499;,citation_doi=10.5281/zenodo.59499;">
<meta name="citation_reference" content="citation_title=Xarray: N-D labeled arrays and datasets in Python;,citation_author=S. Hoyer;,citation_author=J. Hamman;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.5334/jors.148;,citation_issue=1;,citation_doi=10.5334/jors.148;,citation_volume=5;,citation_journal_title=Journal of Open Research Software;,citation_publisher=Ubiquity Press;">
<meta name="citation_reference" content="citation_title=Pandas-dev/pandas: pandas;,citation_author=The team;,citation_publication_date=2020-02;,citation_cover_date=2020-02;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.5281/zenodo.3509134;,citation_doi=10.5281/zenodo.3509134;,citation_publisher=Zenodo;">
<meta name="citation_reference" content="citation_title=Data Structures for Statistical Computing in Python;,citation_author=undefined McKinney;,citation_editor=undefined Walt;,citation_editor=undefined Millman;,citation_publication_date=2010;,citation_cover_date=2010;,citation_year=2010;,citation_doi= 10.25080/Majora-92bf1922-00a ;,citation_conference_title=Proceedings of the 9th Python in Science Conference;">
<meta name="citation_reference" content="citation_title=Pandas-dev/pandas: pandas;,citation_author=The team;,citation_publication_date=2020-02;,citation_cover_date=2020-02;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.5281/zenodo.3509134;,citation_doi=10.5281/zenodo.3509134;,citation_publisher=Zenodo;">
<meta name="citation_reference" content="citation_title=SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python;,citation_author=Pauli Virtanen;,citation_author=Ralf Gommers;,citation_author=Travis E. Oliphant;,citation_author=Matt Haberland;,citation_author=Tyler Reddy;,citation_author=David Cournapeau;,citation_author=Evgeni Burovski;,citation_author=Pearu Peterson;,citation_author=Warren Weckesser;,citation_author=Jonathan Bright;,citation_author=Stéfan J. Walt;,citation_author=Matthew Brett;,citation_author=Joshua Wilson;,citation_author=K. Jarrod Millman;,citation_author=Nikolay Mayorov;,citation_author=Andrew R. J. Nelson;,citation_author=Eric Jones;,citation_author=Robert Kern;,citation_author=Eric Larson;,citation_author=C J Carey;,citation_author=İlhan Polat;,citation_author=Yu Feng;,citation_author=Eric W. Moore;,citation_author=Jake VanderPlas;,citation_author=Denis Laxalde;,citation_author=Josef Perktold;,citation_author=Robert Cimrman;,citation_author=Ian Henriksen;,citation_author=E. A. Quintero;,citation_author=Charles R. Harris;,citation_author=Anne M. Archibald;,citation_author=Antônio H. Ribeiro;,citation_author=Fabian Pedregosa;,citation_author=Paul Mulbregt;,citation_author=SciPy 1.0 Contributors;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_fulltext_html_url=https://doi.org/10.1038/s41592-019-0686-2;,citation_volume=17;,citation_journal_title=Nature Methods;">
<meta name="citation_reference" content="citation_title=Arrow: Integration to ’apache’ ’arrow’;,citation_author=Neal Richardson;,citation_author=Ian Cook;,citation_author=Nic Crane;,citation_author=Dewey Dunnington;,citation_author=Romain François;,citation_author=Jonathan Keane;,citation_author=Dragoș Moldovan-Grünfeld;,citation_author=Jeroen Ooms;,citation_author=Jacob Wujciak-Jens;,citation_author=Apache Arrow;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=arrow;">
<meta name="citation_reference" content="citation_title=Devtools: Tools to make developing r packages easier;,citation_author=Hadley Wickham;,citation_author=Jim Hester;,citation_author=Winston Chang;,citation_author=Jennifer Bryan;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://CRAN.R-project.org/package=devtools;">
<meta name="citation_reference" content="citation_title=Geosphere: Spherical trigonometry;,citation_author=Robert J. Hijmans;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://CRAN.R-project.org/package=geosphere;">
<meta name="citation_reference" content="citation_title=ncdf4: Interface to unidata netCDF (version 4 or earlier) format data files;,citation_author=David Pierce;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://CRAN.R-project.org/package=ncdf4;">
<meta name="citation_reference" content="citation_title=pacman: Package management for R;,citation_author=Tyler W. Rinker;,citation_author=Dason Kurkiewicz;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=http://github.com/trinker/pacman;">
<meta name="citation_reference" content="citation_title=A unifying framework for parallel and distributed processing in r using futures;,citation_author=Henrik Bengtsson;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://doi.org/10.32614/RJ-2021-048;,citation_issue=2;,citation_doi=10.32614/RJ-2021-048;,citation_volume=13;,citation_journal_title=The R Journal;">
<meta name="citation_reference" content="citation_title=Furrr: Apply mapping functions in parallel using futures;,citation_author=Davis Vaughan;,citation_author=Matt Dancho;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://CRAN.R-project.org/package=furrr;">
<meta name="citation_reference" content="citation_title=Rnaturalearth: World map data from natural earth;,citation_author=Philippe Massicotte;,citation_author=Andy South;,citation_fulltext_html_url=https://github.com/ropensci/rnaturalearth;">
</head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Article Notebook</h6>

            <a href="./manuscript.qmd" class="btn btn-primary quarto-download-embed" download="manuscript.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Local to global N input modelling</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#methods" id="toc-methods" class="nav-link active" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#feeding-rate" id="toc-feeding-rate" class="nav-link" data-scroll-target="#feeding-rate">Feeding rate</a></li>
  <li><a href="#farm-temperature-forcings" id="toc-farm-temperature-forcings" class="nav-link" data-scroll-target="#farm-temperature-forcings">Farm temperature forcings</a></li>
  <li><a href="#production-parameters" id="toc-production-parameters" class="nav-link" data-scroll-target="#production-parameters">Production parameters</a></li>
  <li><a href="#model-parameterisation" id="toc-model-parameterisation" class="nav-link" data-scroll-target="#model-parameterisation">Model parameterisation</a>
  <ul class="collapse">
  <li><a href="#parameter-sensitivity" id="toc-parameter-sensitivity" class="nav-link" data-scroll-target="#parameter-sensitivity">Parameter sensitivity</a></li>
  </ul></li>
  <li><a href="#sec-feeds" id="toc-sec-feeds" class="nav-link" data-scroll-target="#sec-feeds">Modelled experimental feeds</a></li>
  <li><a href="#model-population-and-biomass" id="toc-model-population-and-biomass" class="nav-link" data-scroll-target="#model-population-and-biomass">Model population and biomass</a></li>
  <li><a href="#impacts-of-nutrient-input" id="toc-impacts-of-nutrient-input" class="nav-link" data-scroll-target="#impacts-of-nutrient-input">Impacts of nutrient input</a></li>
  </ul></li>
  <li><a href="#statistical-analysis-code-availability" id="toc-statistical-analysis-code-availability" class="nav-link" data-scroll-target="#statistical-analysis-code-availability">Statistical analysis &amp; code availability</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#uneaten-feed" id="toc-uneaten-feed" class="nav-link" data-scroll-target="#uneaten-feed">Uneaten feed</a></li>
  <li><a href="#excreted-faeces" id="toc-excreted-faeces" class="nav-link" data-scroll-target="#excreted-faeces">Excreted faeces</a>
  <ul class="collapse">
  <li><a href="#amount" id="toc-amount" class="nav-link" data-scroll-target="#amount">Amount</a></li>
  <li><a href="#composition" id="toc-composition" class="nav-link" data-scroll-target="#composition">Composition</a></li>
  </ul></li>
  <li><a href="#total-nutrients" id="toc-total-nutrients" class="nav-link" data-scroll-target="#total-nutrients">Total nutrients</a></li>
  </ul></li>
  <li><a href="#supplementary-materials" id="toc-supplementary-materials" class="nav-link" data-scroll-target="#supplementary-materials">Supplementary materials</a>
  <ul class="collapse">
  <li><a href="#sec-parameter-sensitivity" id="toc-sec-parameter-sensitivity" class="nav-link" data-scroll-target="#sec-parameter-sensitivity">Parameter sensitivity</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div class="cell-container code-fold"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:magrittr':

    extract</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.4.3</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggh4x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggh4x' was built under R version 4.4.3</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at C:/Users/treimer/Documents/R-temp-files/local_to_global_mariculture_modelling</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'cowplot'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggpubr':

    get_legend</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'patchwork'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:cowplot':

    align_plots</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'qs' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>qs 0.27.3. Announcement: https://github.com/qsbase/qs/issues/103</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'arrow'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:magrittr':

    is_in</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:utils':

    timestamp</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.13.0, GDAL 3.10.1, PROJ 9.5.1; sf_use_s2() is TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'terra' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>terra 1.8.54</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'terra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:arrow':

    buffer</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:patchwork':

    area</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggpubr':

    rotate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:magrittr':

    extract, inset</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rnaturalearthdata'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:rnaturalearth':

    countries110</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthhires)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dtplyr)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(furrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: future</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'purrr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:magrittr':

    set_names</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readxl' was built under R version 4.4.3</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(units)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'units' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>udunits database from C:/Users/treimer/AppData/Local/R/cache/R/renv/cache/v5/windows/R-4.4/x86_64-w64-mingw32/units/0.8-7/5d0b024902d5da97a2b64f002e92a869/units/share/udunits/udunits2.xml</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(conflicted)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(), dplyr<span class="sc">::</span><span class="fu">filter</span>(), dplyr<span class="sc">::</span><span class="fu">intersect</span>(), <span class="at">.quiet =</span> T)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This markdown uses TinyTex - install with tinytex::install_tinytex()</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">remove_unit</span>(<span class="st">"g_fish"</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">remove_unit</span>(<span class="st">"kg_fish"</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="fu">remove_unit</span>(<span class="st">"t_fish"</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="fu">install_unit</span>(<span class="st">"g_fish"</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="fu">install_unit</span>(<span class="st">"kg_fish"</span>, <span class="st">"1000 g_fish"</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="fu">install_unit</span>(<span class="st">"t_fish"</span>, <span class="st">"1000 kg_fish"</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"magrittr"</span>, <span class="st">"dplyr"</span>, <span class="st">"tidyr"</span>, <span class="st">"stringr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"arrow"</span>, <span class="st">"targets"</span>, <span class="st">"sf"</span>, <span class="st">"terra"</span>, <span class="st">"rnaturalearth"</span>, <span class="st">"furrr"</span>, <span class="st">"future"</span>, <span class="st">"units"</span>, <span class="st">"lubridate"</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="fu">here</span>(<span class="st">"00_model_functions.R"</span>) <span class="sc">%&gt;%</span> <span class="fu">source</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [2]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"00_model_functions.R"</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Input paths</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>input_farm_coords_path <span class="ot">&lt;-</span> <span class="fu">here</span>() <span class="sc">%&gt;%</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"_general_data"</span>, <span class="st">"farm_locations"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>input_farm_sst_path <span class="ot">&lt;-</span> <span class="fu">here</span>() <span class="sc">%&gt;%</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"_general_data"</span>, <span class="st">"SST"</span>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>input_species_param_path <span class="ot">&lt;-</span> <span class="fu">here</span>() <span class="sc">%&gt;%</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"atlantic_salmon"</span>, <span class="st">"params"</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>input_feed_profile_path <span class="ot">&lt;-</span> <span class="fu">here</span>() <span class="sc">%&gt;%</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"_general_data"</span>, <span class="st">"diets"</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Output paths</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>output_farm_data_path <span class="ot">&lt;-</span> <span class="fu">here</span>() <span class="sc">%&gt;%</span> <span class="fu">file.path</span>(<span class="st">"outputs"</span>, <span class="st">"farm_data"</span>)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>output_species_data_path <span class="ot">&lt;-</span> <span class="fu">here</span>() <span class="sc">%&gt;%</span> <span class="fu">file.path</span>(<span class="st">"outputs"</span>, <span class="st">"species_data"</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>output_sens_data_path <span class="ot">&lt;-</span> <span class="fu">here</span>() <span class="sc">%&gt;%</span> <span class="fu">file.path</span>(<span class="st">"outputs"</span>, <span class="st">"sensitivity_data"</span>)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>output_farm_growth_data_path <span class="ot">&lt;-</span> <span class="fu">here</span>() <span class="sc">%&gt;%</span> <span class="fu">file.path</span>(<span class="st">"outputs"</span>, <span class="st">"farm_growth_data"</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>output_cohort_growth_data_path <span class="ot">&lt;-</span> <span class="fu">here</span>() <span class="sc">%&gt;%</span> <span class="fu">file.path</span>(<span class="st">"outputs"</span>, <span class="st">"cohort_growth_data"</span>)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>data_analysis_path <span class="ot">&lt;-</span> <span class="fu">here</span>() <span class="sc">%&gt;%</span> <span class="fu">file.path</span>(<span class="st">"outputs"</span>, <span class="st">"data_analysis"</span>)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Filenames</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>farm_coords_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_farm_data_path, <span class="st">"farm_coords.qs"</span>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>species_params_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_species_data_path, <span class="st">"species_params.qs"</span>)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>pop_params_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_species_data_path, <span class="st">"pop_params.qs"</span>)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>feed_params_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_species_data_path, <span class="st">"feed_params.qs"</span>)</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>sens_params_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_species_data_path, <span class="st">"sens_params.qs"</span>)</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>sens_results_files <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_sens_data_path) <span class="sc">%&gt;%</span> <span class="fu">str_subset</span>(<span class="st">"results"</span>)</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>species_params <span class="ot">&lt;-</span> <span class="fu">qread</span>(species_params_file)</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>pop_params <span class="ot">&lt;-</span> <span class="fu">qread</span>(pop_params_file)</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>prettyplot <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>feed_pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"past"</span> <span class="ot">=</span> <span class="st">"#E41A1C"</span>, <span class="st">"reference"</span> <span class="ot">=</span> <span class="st">"#377EB8"</span>, <span class="st">"future"</span> <span class="ot">=</span> <span class="st">"#4DAF4A"</span>)  </span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>cohort_pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#E41A1C"</span>, <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"#377EB8"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"#4DAF4A"</span>, <span class="st">"all"</span> <span class="ot">=</span> <span class="st">"black"</span>)</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>macro_pal <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"protein"</span> <span class="ot">=</span> <span class="st">"darkred"</span>, <span class="st">"P"</span> <span class="ot">=</span> <span class="st">"darkred"</span>, </span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"carbohydrates"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, <span class="st">"C"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>, </span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lipids"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod1"</span>, <span class="st">"L"</span> <span class="ot">=</span> <span class="st">"darkgoldenrod1"</span></span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>This document was last updated at 19:09 on 09 Jun, 2025.</p>
<section id="methods" class="level1">
<h1>Methods</h1>
<section id="feeding-rate" class="level3">
<h3 class="anchored" data-anchor-id="feeding-rate">Feeding rate</h3>
<p>To detail here:</p>
<ul>
<li>Functional response to temperature (species-specific)</li>
<li>Overfeeding parameters and how they come into play</li>
<li>Deminstration of how feeding response and actual food given vary with temperature?</li>
</ul>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [3]:</pre></div><div id="cell-fig-functional-response-to-temperature" class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">water_temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">26</span>, <span class="fl">0.25</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>feeding <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="at">FUN =</span> feeding_rate, <span class="at">X =</span> df<span class="sc">$</span>water_temp, <span class="at">species_params =</span> species_params)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">ing_pot =</span> pop_params[<span class="st">'meanImax'</span>] <span class="sc">*</span> (pop_params[<span class="st">'meanW'</span>]<span class="sc">^</span>species_params[<span class="st">'m'</span>]) <span class="sc">*</span> feeding,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">food_prov =</span> <span class="cn">NA</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df)) {</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>food_prov[i] <span class="ot">&lt;-</span> <span class="fu">food_prov_rate</span>(<span class="at">pop_params =</span> pop_params, <span class="at">rel_feeding =</span> df<span class="sc">$</span>feeding[i], <span class="at">ing_pot =</span> df<span class="sc">$</span>ing_pot[i], </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">ing_pot_10 =</span> pop_params[<span class="st">'meanImax'</span>] <span class="sc">*</span> (pop_params[<span class="st">'meanW'</span>]<span class="sc">^</span>species_params[<span class="st">'m'</span>]) <span class="sc">*</span> <span class="fl">0.1</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>ing_pot <span class="ot">&lt;-</span> df<span class="sc">$</span>ing_pot<span class="sc">/</span><span class="fu">maxna</span>(df<span class="sc">$</span>ing_pot)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>food_prov <span class="ot">&lt;-</span> df<span class="sc">$</span>food_prov<span class="sc">/</span><span class="fu">maxna</span>(df<span class="sc">$</span>ing_pot)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> water_temp, <span class="at">y =</span> ing_pot)) <span class="sc">+</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> food_prov), <span class="at">linewidth =</span> <span class="fl">0.75</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">1.5</span>,<span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">30</span>,<span class="dv">5</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">26</span>)) <span class="sc">+</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Water temperature ("</span><span class="sc">*</span>degree<span class="sc">*</span><span class="st">"C)"</span>), <span class="at">y =</span> <span class="st">"Relative food ingested/provided"</span>) <span class="sc">+</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>() <span class="sc">+</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
<section id="farm-temperature-forcings" class="level2">
<h2 class="anchored" data-anchor-id="farm-temperature-forcings">Farm temperature forcings</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [4]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Get general farm info</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>farms_to_omit <span class="ot">&lt;-</span> <span class="fu">file.path</span>(input_farm_coords_path, <span class="st">"atlantic_salmon_farms_to_omit.qs"</span>) <span class="sc">%&gt;%</span> qs<span class="sc">::</span><span class="fu">qread</span>()</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>farm_ts_data <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_farm_data_path, <span class="st">"farm_ts_data.qs"</span>) <span class="sc">%&gt;%</span> qs<span class="sc">::</span><span class="fu">qread</span>()</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>farm_coords <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_farm_data_path, <span class="st">"farm_coords.qs"</span>) <span class="sc">%&gt;%</span> qs<span class="sc">::</span><span class="fu">qread</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">hemisphere =</span> <span class="fu">case_when</span>(lat <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"S"</span>, T <span class="sc">~</span> <span class="st">"N"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()) </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>farms_geometry <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_farm_data_path, <span class="st">"farm_geometry.qs"</span>) <span class="sc">%&gt;%</span> qs<span class="sc">::</span><span class="fu">qread</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">farm_ID =</span> farm_id)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>sorted_countries <span class="ot">&lt;-</span> farm_coords <span class="sc">%&gt;%</span> </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(farms_geometry, <span class="at">by =</span> <span class="st">"farm_ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span> </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">av_lat =</span> <span class="fu">mean</span>(lat)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>av_lat) <span class="sc">%&gt;%</span> </span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(country) <span class="sc">%&gt;%</span> </span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Get the farm temperature forcings</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>farm_temp_means <span class="ot">&lt;-</span> farm_ts_data <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(farm_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">mean_temp =</span> <span class="fu">mean</span>(temp_c)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(farms_geometry, <span class="at">by =</span> <span class="st">"farm_ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(farm_coords, <span class="at">by =</span> <span class="st">"farm_ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>farm_ID <span class="sc">%in%</span> farms_to_omit)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(farm_temp_means<span class="sc">$</span>mean_temp)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>overall_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(farm_temp_means<span class="sc">$</span>mean_temp)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(farm_ts_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Mean daily temperatures at the farms globally ranged from from 6<span class="math inline">\(^{\circ}\)</span>C to 16.7<span class="math inline">\(^{\circ}\)</span>C, with an overall mean of 10.1<span class="math inline">\(^{\circ}\)</span>C (<span class="math inline">\(\pm\)</span> 1.8<span class="math inline">\(^{\circ}\)</span>C SD). Farms with a mean temperature of $<span class="math inline">\(6\)</span>^$C were excluded (4 farms). The total number of farms included in the analysis was therefore 2717.</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [6]:</pre></div><div id="cell-fig-farm-mean-temps" class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>worldmap <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">"medium"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="st">"+proj=robin"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>graticules <span class="ot">&lt;-</span> <span class="fu">st_graticule</span>(worldmap, <span class="at">lon =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">180</span>, <span class="dv">180</span>, <span class="dv">30</span>), <span class="at">lat =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">90</span>, <span class="dv">90</span>, <span class="dv">30</span>)) </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>inset_boxes <span class="ot">&lt;-</span> <span class="fu">list</span>(   <span class="co"># lonmin, lonmax, latmin, latmax</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">CAN1 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">132</span>, <span class="sc">-</span><span class="dv">122</span>, <span class="fl">47.75</span>, <span class="fl">54.25</span>),</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">CAN2 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">70</span>, <span class="sc">-</span><span class="dv">54</span>, <span class="dv">43</span>, <span class="fl">48.5</span>),</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">EUR =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">26</span>, <span class="dv">30</span>, <span class="dv">51</span>, <span class="dv">72</span>),</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">CHI =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">77.5</span>, <span class="sc">-</span><span class="fl">62.5</span>, <span class="sc">-</span><span class="dv">56</span>, <span class="sc">-</span><span class="dv">25</span>),</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">AUS =</span> <span class="fu">c</span>(<span class="dv">144</span>, <span class="fl">149.5</span>, <span class="sc">-</span><span class="dv">44</span>, <span class="sc">-</span><span class="fl">39.75</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>labels_spec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">CAN1 =</span> <span class="st">"bottom_left_outside"</span>, <span class="at">CAN2 =</span> <span class="st">"bottom_right_outside"</span>, <span class="at">EUR =</span> <span class="st">"bottom_left_outside"</span>, <span class="at">CHI =</span> <span class="st">"top_left_outside"</span>, <span class="at">AUS =</span> <span class="st">"bottom_left_outside"</span>)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>labels_offset <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">CAN1 =</span> <span class="dv">1</span>, <span class="at">CAN2 =</span> <span class="dv">2</span>, <span class="at">EUR =</span> <span class="fl">1.75</span>, <span class="at">CHI =</span> <span class="fl">1.75</span>, <span class="at">AUS =</span> <span class="fl">3.5</span>)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>box_data <span class="ot">&lt;-</span> <span class="fu">create_boxes</span>(<span class="at">box_list =</span> inset_boxes, <span class="co"># see function create_boxes above</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label_positions =</span> <span class="fu">unname</span>(labels_spec),</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">offset_deg =</span> <span class="fu">unname</span>(labels_offset))</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>boxes_robinson <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(box_data<span class="sc">$</span>boxes, <span class="at">crs =</span> <span class="st">"+proj=robin"</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>labels_robinson <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(box_data<span class="sc">$</span>labels, <span class="at">crs =</span> <span class="st">"+proj=robin"</span>)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>farm_temp_robinson <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(farm_temp_means) <span class="sc">%&gt;%</span> <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="st">"+proj=robin"</span>)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> graticules, <span class="at">color =</span> <span class="st">"gray80"</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> worldmap, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"dimgray"</span>) <span class="sc">+</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> farm_temp_robinson, <span class="fu">aes</span>(<span class="at">color =</span> mean_temp), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>() <span class="sc">+</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"turbo"</span>) <span class="sc">+</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="fu">guide_colourbar</span>(</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean temperature (°C)"</span>,</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"horizontal"</span>, <span class="at">position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">"bottom"</span>, <span class="at">title.position =</span> <span class="st">"top"</span>, </span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.vjust =</span> <span class="dv">1</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame.colour =</span> <span class="st">"black"</span>, <span class="at">ticks.colour =</span> <span class="st">"black"</span>,<span class="at">ticks.linewidth =</span> <span class="dv">2</span>,</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">barwidth =</span> <span class="dv">25</span>,<span class="at">barheight =</span> <span class="fl">1.5</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> boxes_robinson, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">size =</span> <span class="fl">1.65</span>) <span class="sc">+</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_text</span>(<span class="at">data =</span> labels_robinson, <span class="fu">aes</span>(<span class="at">label =</span> letter), </span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, </span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>               <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> farm_temp_means <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean_temp, <span class="at">x =</span> <span class="fu">abs</span>(lat), <span class="at">colour =</span> country)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Absolute latitude ("</span><span class="sc">*</span>degree<span class="sc">*</span><span class="st">")"</span>), <span class="at">y =</span> <span class="fu">expression</span>(<span class="st">"Mean temperature ("</span><span class="sc">*</span>degree<span class="sc">*</span><span class="st">"C)"</span>)) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>() <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> farm_temp_means <span class="sc">%&gt;%</span> </span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hemisphere =</span> <span class="fu">case_when</span>(lat <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"S"</span>, T <span class="sc">~</span> <span class="st">"N"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_temp, <span class="at">fill =</span> hemisphere)) <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(<span class="st">"Mean temperature ("</span><span class="sc">*</span>degree<span class="sc">*</span><span class="st">"C)"</span>), <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>() <span class="sc">+</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>(p2 <span class="sc">+</span> p3) <span class="sc">/</span> p1 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-farm-mean-temps" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-farm-mean-temps-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="manuscript_files/figure-html/fig-farm-mean-temps-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Potential options for showing data spatially. Top left: Mean temperature by latitude across countries. Top right: Frequency distribution of mean temperatures by hemisphere. Bottom: global distribution of mean temperatures."><img src="manuscript_files/figure-html/fig-farm-mean-temps-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="912"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-farm-mean-temps-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Potential options for showing data spatially. Top left: Mean temperature by latitude across countries. Top right: Frequency distribution of mean temperatures by hemisphere. Bottom: global distribution of mean temperatures.
</figcaption>
</figure>
</div>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [7]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>no_margins <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>inset_boxes_sm <span class="ot">&lt;-</span> <span class="fu">list</span>(   <span class="co"># lonmin, lonmax, latmin, latmax</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">CAN1 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">132</span>, <span class="sc">-</span><span class="dv">122</span>, <span class="fl">48.5</span>, <span class="dv">54</span>),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">CAN2 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">70</span>, <span class="sc">-</span><span class="dv">54</span>, <span class="dv">43</span>, <span class="fl">48.5</span>),</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">EUR =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">23</span>, <span class="fl">28.5</span>, <span class="dv">52</span>, <span class="dv">71</span>),</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">CHI =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">78</span>, <span class="sc">-</span><span class="dv">62</span>, <span class="sc">-</span><span class="fl">55.5</span>, <span class="sc">-</span><span class="dv">27</span>),</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">AUS =</span> <span class="fu">c</span>(<span class="dv">144</span>, <span class="dv">149</span>, <span class="sc">-</span><span class="fl">43.75</span>, <span class="sc">-</span><span class="fl">40.75</span>)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>inset_boxes_sm <span class="ot">&lt;-</span> <span class="fu">map</span>(inset_boxes_sm, <span class="cf">function</span>(bx) {</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlims =</span> bx[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylims =</span> bx[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">labx =</span> bx[<span class="dv">1</span>],</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">laby =</span> bx[<span class="dv">4</span>]</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>worldmap <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">"large"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> worldmap, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"dimgray"</span>) <span class="sc">+</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> farm_temp_means, <span class="fu">aes</span>(<span class="at">color =</span> mean_temp, <span class="at">geometry =</span> geometry), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>() <span class="sc">+</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"turbo"</span>) <span class="sc">+</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="fu">guide_colourbar</span>(</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean temperature (°C)"</span>,</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"vertical"</span>, <span class="at">position =</span> <span class="st">"right"</span>,</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.position =</span> <span class="st">"right"</span>, <span class="at">title.position =</span> <span class="st">"top"</span>, </span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.vjust =</span> <span class="dv">1</span>, <span class="at">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">frame.colour =</span> <span class="st">"black"</span>, <span class="at">ticks.colour =</span> <span class="st">"black"</span>,<span class="at">ticks.linewidth =</span> <span class="dv">2</span>,</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">barwidth =</span> <span class="fl">1.5</span>, <span class="at">barheight =</span> <span class="dv">20</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>() <span class="sc">+</span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Latitude"</span>, <span class="at">x =</span> <span class="st">"Longitude"</span>)</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>p_Can1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> </span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> inset_boxes_sm[[<span class="st">"CAN1"</span>]][[<span class="st">"xlims"</span>]], </span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> inset_boxes_sm[[<span class="st">"CAN1"</span>]][[<span class="st">"ylims"</span>]])  <span class="sc">+</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_label</span>(<span class="st">"A"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, </span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> inset_boxes_sm[[<span class="st">"CAN1"</span>]][[<span class="st">"labx"</span>]], </span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> inset_boxes_sm[[<span class="st">"CAN1"</span>]][[<span class="st">"laby"</span>]], </span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>p_Can2 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> inset_boxes_sm[[<span class="st">"CAN2"</span>]][[<span class="st">"xlims"</span>]], </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> inset_boxes_sm[[<span class="st">"CAN2"</span>]][[<span class="st">"ylims"</span>]])  <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_label</span>(<span class="st">"B"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> inset_boxes_sm[[<span class="st">"CAN2"</span>]][[<span class="st">"labx"</span>]], </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> inset_boxes_sm[[<span class="st">"CAN2"</span>]][[<span class="st">"laby"</span>]], </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>p_Eur <span class="ot">&lt;-</span> p1 <span class="sc">+</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> inset_boxes_sm[[<span class="st">"EUR"</span>]][[<span class="st">"xlims"</span>]], </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> inset_boxes_sm[[<span class="st">"EUR"</span>]][[<span class="st">"ylims"</span>]])  <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_label</span>(<span class="st">"C"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> inset_boxes_sm[[<span class="st">"EUR"</span>]][[<span class="st">"labx"</span>]], </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> inset_boxes_sm[[<span class="st">"EUR"</span>]][[<span class="st">"laby"</span>]], </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>p_Chi <span class="ot">&lt;-</span> p1 <span class="sc">+</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> inset_boxes_sm[[<span class="st">"CHI"</span>]][[<span class="st">"xlims"</span>]], </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> inset_boxes_sm[[<span class="st">"CHI"</span>]][[<span class="st">"ylims"</span>]])  <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_label</span>(<span class="st">"D"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> inset_boxes_sm[[<span class="st">"CHI"</span>]][[<span class="st">"labx"</span>]], </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> inset_boxes_sm[[<span class="st">"CHI"</span>]][[<span class="st">"laby"</span>]], </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>p_Aus <span class="ot">&lt;-</span> p1 <span class="sc">+</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> inset_boxes_sm[[<span class="st">"AUS"</span>]][[<span class="st">"xlims"</span>]], </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim =</span> inset_boxes_sm[[<span class="st">"AUS"</span>]][[<span class="st">"ylims"</span>]])  <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_label</span>(<span class="st">"E"</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">x =</span> inset_boxes_sm[[<span class="st">"AUS"</span>]][[<span class="st">"labx"</span>]], </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> inset_boxes_sm[[<span class="st">"AUS"</span>]][[<span class="st">"laby"</span>]], </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Coordinate system already present. Adding new coordinate system, which will
replace the existing one.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>grid_1 <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p_Can1, p_Can2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">rel_widths =</span>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.35</span>))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>grid_2 <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p_Eur,  p_Aus,  <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>grid_3 <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(grid_2, p_Chi,  <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">rel_widths =</span>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  grid_1, grid_3,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>)        <span class="co"># relative row heights</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p class=""><a href="manuscript_files/figure-html/patchwork-map-mercator-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Example of a patchwork"><img src="manuscript_files/figure-html/patchwork-map-mercator-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="912" alt="Example of a patchwork"></a></p>
</figure>
</div>
<figcaption>Example of a patchwork</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="production-parameters" class="level2">
<h2 class="anchored" data-anchor-id="production-parameters">Production parameters</h2>
<p>Salmon were grown for 548 days and were initialised Spring. This was on day 274 for farms in the southern hemisphere and day 121 for farms in the northern hemisphere. Cohorts were initialised anually, such that there was an overlap of 183 days where one cohort was nearing harvest and another was being initialised.</p>
</section>
<section id="model-parameterisation" class="level2">
<h2 class="anchored" data-anchor-id="model-parameterisation">Model parameterisation</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Get parameter and sensitivity data</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_species_data_path, <span class="st">"sens_params.qs"</span>) <span class="sc">%&gt;%</span> qs<span class="sc">::</span><span class="fu">qread</span>()</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>param_names <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>name,        <span class="sc">~</span>lab,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"alpha"</span>,      <span class="fu">bquote</span>(alpha),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"epsprot"</span>,    <span class="fu">bquote</span>(epsilon[<span class="st">"P"</span>]),</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"epslip"</span>,     <span class="fu">bquote</span>(epsilon[<span class="st">"L"</span>]),</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"epscarb"</span>,    <span class="fu">bquote</span>(epsilon[<span class="st">"C"</span>]),</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"epsO2"</span>,      <span class="fu">bquote</span>(epsilon[<span class="st">"O"</span>[<span class="dv">2</span>]]),</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pk"</span>,         <span class="fu">bquote</span>(<span class="st">"pk"</span>),</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"k0"</span>,         <span class="fu">bquote</span>(<span class="st">"k"</span>[<span class="dv">0</span>]),</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"m"</span>,          <span class="fu">bquote</span>(<span class="st">"m"</span>),</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"n"</span>,          <span class="fu">bquote</span>(<span class="st">"n"</span>),</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"betac"</span>,      <span class="fu">bquote</span>(beta<span class="sc">*</span><span class="st">"C"</span>),</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tma"</span>,        <span class="fu">bquote</span>(<span class="st">"T"</span>[<span class="st">"max"</span>]),</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Toa"</span>,        <span class="fu">bquote</span>(<span class="st">"T"</span>[<span class="st">"opt"</span>]),</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Taa"</span>,        <span class="fu">bquote</span>(<span class="st">"T"</span>[<span class="st">"min"</span>]),</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"omega"</span>,      <span class="fu">bquote</span>(omega),</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"a"</span>,          <span class="fu">bquote</span>(<span class="st">"a"</span>),</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"k"</span>,          <span class="fu">bquote</span>(<span class="st">"k"</span>),</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"eff"</span>,        <span class="fu">bquote</span>(<span class="st">"eff"</span>),</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"meanW"</span>,      <span class="fu">bquote</span>(<span class="fu">bar</span>(<span class="st">"W"</span>)),</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"deltaW"</span>,     <span class="fu">bquote</span>(Delta<span class="sc">*</span><span class="st">"W"</span>), </span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"meanImax"</span>,   <span class="fu">bquote</span>(<span class="fu">bar</span>(<span class="st">"I"</span>[<span class="st">"max"</span>])),</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"deltaImax"</span>,  <span class="fu">bquote</span>(Delta<span class="sc">*</span><span class="st">"I"</span>[<span class="st">"max"</span>]),</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"overFmean"</span>,  <span class="fu">bquote</span>(<span class="fu">bar</span>(<span class="st">"F"</span>)),</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"overFdelta"</span>, <span class="fu">bquote</span>(Delta<span class="sc">*</span><span class="st">"F"</span>),</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"mortmyt"</span>,    <span class="fu">bquote</span>(<span class="st">"mort"</span>)</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p><a href="#tbl-params" class="quarto-xref">Table&nbsp;1</a> shows the parameter values used to model the growth of farmed Atlantic salmon.</p>
<div id="tbl-params" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-params-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Model growth parameters for Atlantic salmon
</figcaption>
<div aria-describedby="tbl-params-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Parameter</th>
<th style="text-align: center;">Value</th>
<th style="text-align: center;">Units</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\alpha\)</span></td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">Feeding catabolism coefficient</td>
<td style="text-align: left;"><em>Salvelinus alpinus</em>, <em>Oncorhynchus mykiss</em> (temps: 8–13<span class="math inline">\(^{\circ}\)</span>C) <span class="citation" data-cites="broekhuizen_modelling_1994">(<a href="#ref-broekhuizen_modelling_1994" role="doc-biblioref">Broekhuizen et al. 1994</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\epsilon_{P}\)</span></td>
<td style="text-align: center;">2.36^{4}</td>
<td style="text-align: center;">J g<span class="math inline">\(^{-1}\)</span></td>
<td style="text-align: left;">Energy content of protein</td>
<td style="text-align: left;"><span class="citation" data-cites="baldan_r_2018">Baldan et al. (<a href="#ref-baldan_r_2018" role="doc-biblioref">2018</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\epsilon_{L}\)</span></td>
<td style="text-align: center;">3.62^{4}</td>
<td style="text-align: center;">J g<span class="math inline">\(^{-1}\)</span></td>
<td style="text-align: left;">Energy content of lipid</td>
<td style="text-align: left;"><span class="citation" data-cites="baldan_r_2018">Baldan et al. (<a href="#ref-baldan_r_2018" role="doc-biblioref">2018</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\epsilon_{C}\)</span></td>
<td style="text-align: center;">1.72^{4}</td>
<td style="text-align: center;">J g<span class="math inline">\(^{-1}\)</span></td>
<td style="text-align: left;">Energy content of carbohydrate</td>
<td style="text-align: left;"><span class="citation" data-cites="baldan_r_2018">Baldan et al. (<a href="#ref-baldan_r_2018" role="doc-biblioref">2018</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\epsilon_{O_2}\)</span></td>
<td style="text-align: center;">1.34^{4}</td>
<td style="text-align: center;">J g O<span class="math inline">\(_2^{-1}\)</span></td>
<td style="text-align: left;">Energy consumed by the respiration of 1 g of oxygen</td>
<td style="text-align: left;"><span class="citation" data-cites="elliott_energy_1975">Elliott and Davison (<a href="#ref-elliott_energy_1975" role="doc-biblioref">1975</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(p_k\)</span></td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">d<span class="math inline">\(^{-1}\)</span></td>
<td style="text-align: left;">Temperature coefficient for the fasting catabolism</td>
<td style="text-align: left;"><span class="citation" data-cites="macnaughton_using_2019">Macnaughton et al. (<a href="#ref-macnaughton_using_2019" role="doc-biblioref">2019</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(k_0\)</span></td>
<td style="text-align: center;">0.003</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">Fasting catabolism at 0 <span class="math inline">\(^{^\circ}\)</span>C</td>
<td style="text-align: left;"><span class="citation" data-cites="macnaughton_using_2019">Macnaughton et al. (<a href="#ref-macnaughton_using_2019" role="doc-biblioref">2019</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(m\)</span></td>
<td style="text-align: center;">0.75</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">Weight exponent for anabolism</td>
<td style="text-align: left;">Experimentally-derived alue over a range of <em>Oncorhynchus</em>, <em>Perca</em> and <em>Salmo</em> species (temps: 8–13<span class="math inline">\(^{\circ}\)</span>C) <span class="citation" data-cites="broekhuizen_modelling_1994">(<a href="#ref-broekhuizen_modelling_1994" role="doc-biblioref">Broekhuizen et al. 1994</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(n\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">Weight exponent for catabolism</td>
<td style="text-align: left;"><span class="citation" data-cites="baldan_r_2018">Baldan et al. (<a href="#ref-baldan_r_2018" role="doc-biblioref">2018</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\beta C\)</span></td>
<td style="text-align: center;">0.3234</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">Shape coefficient for the feeding function</td>
<td style="text-align: left;">Fish size range: 2.25 <span class="math inline">\(\pm\)</span> 0.49 – 11.5 <span class="math inline">\(\pm\)</span> 5.29 g, temperature ranges: 5–24<span class="math inline">\(^{\circ}\)</span>C. Coefficient for mean daily energy intake of the moderately fast growing group, 0.4398 (mean fast group), 0.2214 (mean slow group) <span class="citation" data-cites="jonsson_thermal_2001">(<a href="#ref-jonsson_thermal_2001" role="doc-biblioref">B. Jonsson et al. 2001</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(T_{max}\)</span></td>
<td style="text-align: center;">26</td>
<td style="text-align: center;"><span class="math inline">\(^{\circ}\)</span>C</td>
<td style="text-align: left;">Maximum lethal temperature</td>
<td style="text-align: left;">Juvenile <em>Oncorhynchus tshawytscha</em> (19.8 <span class="math inline">\(\pm\)</span> 0.02 g, acclimation temp: 15<span class="math inline">\(^{^\circ}\)</span>C, 19<span class="math inline">\({\circ}\)</span>C) <span class="citation" data-cites="poletto_unusual_2017">(<a href="#ref-poletto_unusual_2017" role="doc-biblioref">Poletto et al. 2017</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(T_{opt}\)</span></td>
<td style="text-align: center;">16</td>
<td style="text-align: center;"><span class="math inline">\(^{\circ}\)</span>C</td>
<td style="text-align: left;">Optimal temperature</td>
<td style="text-align: left;">Fish size range: 2.25 <span class="math inline">\(\pm\)</span> 0.49 – 11.5 <span class="math inline">\(\pm\)</span> 5.29 g, temperature ranges: 5–24<span class="math inline">\(^{^\circ}\)</span>C <span class="citation" data-cites="jonsson_thermal_2001">(<a href="#ref-jonsson_thermal_2001" role="doc-biblioref">B. Jonsson et al. 2001</a>)</span>. Alt value: 14°C <span class="citation" data-cites="handeland_effect_2008">(<a href="#ref-handeland_effect_2008" role="doc-biblioref">Handeland, Imsland, and Stefansson 2008</a>)</span>, <em>Salmo salar</em> initial size: 77.0 <span class="math inline">\(\pm\)</span> 14.6 g, temps: 6, 10, 14, 18<span class="math inline">\({\circ}\)</span>C</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(T_{min}\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(^{\circ}\)</span>C</td>
<td style="text-align: left;">Lowest feeding temperature</td>
<td style="text-align: left;">Fish essentially stop feeding when below 2<span class="math inline">\(^{\circ}\)</span>C <span class="citation" data-cites="vadboncoeur_lowering_2023">(<a href="#ref-vadboncoeur_lowering_2023" role="doc-biblioref">Vadboncoeur et al. 2023</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\omega\)</span></td>
<td style="text-align: center;">0.6542</td>
<td style="text-align: center;">g O<span class="math inline">\(_2\)</span> g<span class="math inline">\(^{-1}\)</span></td>
<td style="text-align: left;">Oxygen consumption:weight loss ratio</td>
<td style="text-align: left;">Calibrated value from <span class="citation" data-cites="baldan_r_2018">Baldan et al. (<a href="#ref-baldan_r_2018" role="doc-biblioref">2018</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(a\)</span></td>
<td style="text-align: center;">2669</td>
<td style="text-align: center;">J g tissue<span class="math inline">\(^{-1}\)</span></td>
<td style="text-align: left;">Energy content of fish tissue</td>
<td style="text-align: left;">Alt value: 17.02350 (nls model fitted to female Atlantic salmon data extracted and transformed from <span class="citation" data-cites="jonsson_energy_2003 van_tien_development_2016">N. Jonsson and Jonsson (<a href="#ref-jonsson_energy_2003" role="doc-biblioref">2003</a>; <a href="#ref-van_tien_development_2016" role="doc-biblioref">Van Tien et al. 2016</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(k\)</span></td>
<td style="text-align: center;">0.1715</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">Weight exponent for energy content</td>
<td style="text-align: left;">Alt value: 1.65175 (nls model fitted to female Atlantic salmon data extracted and transformed from <span class="citation" data-cites="jonsson_energy_2003 van_tien_development_2016">N. Jonsson and Jonsson (<a href="#ref-jonsson_energy_2003" role="doc-biblioref">2003</a>; <a href="#ref-van_tien_development_2016" role="doc-biblioref">Van Tien et al. 2016</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(eff\)</span></td>
<td style="text-align: center;">0.97</td>
<td style="text-align: center;">-</td>
<td style="text-align: left;">Food ingestion efficiency</td>
<td style="text-align: left;">Range: 95-97% ingestion efficiency <span class="citation" data-cites="uglem_does_2020">(<a href="#ref-uglem_does_2020" role="doc-biblioref">Uglem et al. 2020</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\overline{W}\)</span></td>
<td style="text-align: center;">125</td>
<td style="text-align: center;">g</td>
<td style="text-align: left;">Dry weight mean</td>
<td style="text-align: left;">Range of 100-150 given so used a mean of 125 and sd of 10 which over 1000 draws from a normal distribution delivers a minimum and maximum close to these numbers <span class="citation" data-cites="dempsey_estimating_2023">(<a href="#ref-dempsey_estimating_2023" role="doc-biblioref">Dempsey et al. 2023</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\Delta{W}\)</span></td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">g</td>
<td style="text-align: left;">Dry weight standard deviation</td>
<td style="text-align: left;">Range of 100-150 given so used a mean of 125 and sd of 10 which over 1000 draws from a normal distribution delivers a minimum and maximum close to these numbers <span class="citation" data-cites="dempsey_estimating_2023">(<a href="#ref-dempsey_estimating_2023" role="doc-biblioref">Dempsey et al. 2023</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\overline{I_{max}}\)</span></td>
<td style="text-align: center;">0.035</td>
<td style="text-align: center;">g g<span class="math inline">\(^{-1}\)</span> fish d<span class="math inline">\(^{-1}\)</span></td>
<td style="text-align: left;">Ingestion rate mean</td>
<td style="text-align: left;"><a href="https://www.fao.org/fileadmin/user_upload/affris/docs/tabl10.pdf">FAO</a></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\Delta{I_{max}}\)</span></td>
<td style="text-align: center;">0.005</td>
<td style="text-align: center;">g g<span class="math inline">\(^{-1}\)</span> fish d<span class="math inline">\(^{-1}\)</span></td>
<td style="text-align: left;">Ingestion rate standard deviation</td>
<td style="text-align: left;"><a href="https://www.fao.org/fileadmin/user_upload/affris/docs/tabl10.pdf">FAO</a></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\overline{F}\)</span></td>
<td style="text-align: center;">0.015</td>
<td style="text-align: center;">g g<span class="math inline">\(^{-1}\)</span> fish</td>
<td style="text-align: left;">Overfeeding rate mean</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\Delta{F}\)</span></td>
<td style="text-align: center;">0.0045</td>
<td style="text-align: center;">g g<span class="math inline">\(^{-1}\)</span> fish</td>
<td style="text-align: left;">Overfeeding rate standard deviation</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(mort\)</span></td>
<td style="text-align: center;">5.99798^{-4}</td>
<td style="text-align: center;">d<span class="math inline">\(^{-1}\)</span></td>
<td style="text-align: left;">Natural mortality rate</td>
<td style="text-align: left;"><span class="citation" data-cites="tvete_towards_2023">Tvete, Aldrin, and Jensen (<a href="#ref-tvete_towards_2023" role="doc-biblioref">2023</a>)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<section id="parameter-sensitivity" class="level3">
<h3 class="anchored" data-anchor-id="parameter-sensitivity">Parameter sensitivity</h3>
<p>Parameter sensitivity was tested by varying each parameter in <a href="#tbl-params" class="quarto-xref">Table&nbsp;1</a> by <span class="math inline">\(\pm 10\)</span>% and calculating sensitivity as <span class="math inline">\(S_p = \frac{(P_{1.1} - P_{0.9})}{0.2 \times P_1}\)</span>, where <span class="math inline">\(S\)</span> is the sensitivity of the measured variable to changes in parameter <span class="math inline">\(p\)</span>, and <span class="math inline">\(P_{1.1}\)</span>, <span class="math inline">\(P_{0.9}\)</span>, and <span class="math inline">\(P_{1}\)</span> are the value of the measured variable when the model is run with parameter <span class="math inline">\(p\)</span> at 110%, 90%, and 100% of its value respectively. All parameters in Table <a href="#tbl-params" class="quarto-xref">Table&nbsp;1</a> were tested. The population-level parameters (<span class="math inline">\(\overline{W}\)</span>, <span class="math inline">\(\Delta{W}\)</span>, <span class="math inline">\(\overline{I_{max}}\)</span>, <span class="math inline">\(\Delta{I_{max}}\)</span>, <span class="math inline">\(\overline{F}\)</span>, <span class="math inline">\(\Delta{F}\)</span>) were tested with a population of of 5000 on a random 10% of farms, while all other parameters were tested across all farms with a population of 10.</p>
</section>
</section>
<section id="sec-feeds" class="level2">
<h2 class="anchored" data-anchor-id="sec-feeds">Modelled experimental feeds</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [9]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>feed_params <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_species_data_path, <span class="st">"feed_params.qs"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  qs<span class="sc">::</span><span class="fu">qread</span>() </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>feed_summary <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">names</span>(feed_params), <span class="cf">function</span>(feed) {</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> feed_params[[feed]]</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="fu">c</span>(<span class="st">"Proteins"</span>, <span class="st">"Lipids"</span>, <span class="st">"Carbohydrates"</span>), <span class="cf">function</span>(macro) {</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    contrib <span class="ot">&lt;-</span> df[[macro]]<span class="sc">$</span>proportion <span class="sc">*</span> df[[macro]]<span class="sc">$</span>macro</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    total <span class="ot">&lt;-</span> <span class="fu">sum</span>(contrib)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    digest <span class="ot">&lt;-</span> <span class="fu">sum</span>(df[[macro]]<span class="sc">$</span>digest <span class="sc">*</span> contrib) <span class="sc">/</span> total</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tibble</span>(</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">feed =</span> feed,</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">macro =</span> macro,</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">total =</span> total,</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">digest =</span> digest</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">macro =</span> <span class="fu">factor</span>(macro, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Proteins"</span>, <span class="st">"Lipids"</span>, <span class="st">"Carbohydrates"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"P"</span>, <span class="st">"L"</span>, <span class="st">"C"</span>)),</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">feed =</span> <span class="fu">factor</span>(feed, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"reference"</span>, <span class="st">"past"</span>, <span class="st">"future"</span>)),</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_r =</span> total <span class="sc">*</span> <span class="dv">100</span> <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">1</span>),</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">digest_r =</span> digest <span class="sc">*</span> <span class="dv">100</span> <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Feeds came from <span class="citation" data-cites="cottrell_origins_nodate cottrell_global_2020">(<a href="#ref-cottrell_origins_nodate" role="doc-biblioref">Cottrell et al., n.d.</a>, <a href="#ref-cottrell_global_2020" role="doc-biblioref">2020</a>)</span>.</p>
<div class=""><p></p><div class="no-row-height"><span class="margin-aside">Plan to put full details of ingredients in a supplementary section. But possibly report these stats in Results under Uneaten feed?</span></div></div>
<p>The reference feed was 37.8% protein, 36.5% lipid, and 20.4% carbohydrate, the past feed was 49.8% protein, 27.1% lipid, and 16.6% carbohydrate, and the future feed was 47.7% protein, 32.9% lipid, and 13.9% carbohydrate.</p>
<p>Ingredients are tracked seperately through the model with their own digestibility coefficients. Overall, proteins within the reference feed were 89.2% digestible, proteins within the past feed were 90.5% digestible, and proteins within the future feed were 86.2% digestible. The digestibility of the other macronutrients are assumed to remain constant across all ingredients at 79.7% for carbohydrates and 96% for lipids.</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [10]:</pre></div><div id="cell-fig-feed-summary-ideas" class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> feed_summary <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">digest_total =</span> digest <span class="sc">*</span> total) <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> feed, <span class="at">y =</span> total, <span class="at">fill =</span> macro)) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.55</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> digest_total), <span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> macro_pal) <span class="sc">+</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"reference"</span> <span class="ot">=</span> <span class="st">"Reference"</span>, <span class="st">"past"</span> <span class="ot">=</span> <span class="st">"Past"</span>, <span class="st">"future"</span> <span class="ot">=</span> <span class="st">"Future"</span>)) <span class="sc">+</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Feed"</span>, <span class="at">y =</span> <span class="st">"Proportion (%)"</span>) <span class="sc">+</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>()</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>feed_ings <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  feed_params[[<span class="dv">1</span>]][[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">feed =</span> <span class="fu">as.factor</span>(<span class="st">"reference"</span>)), </span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  feed_params[[<span class="dv">2</span>]][[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">feed =</span> <span class="fu">as.factor</span>(<span class="st">"past"</span>)), </span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  feed_params[[<span class="dv">3</span>]][[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">feed =</span> <span class="fu">as.factor</span>(<span class="st">"future"</span>))</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">protein =</span> macro) <span class="sc">%&gt;%</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">category =</span> <span class="fu">case_when</span>(</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"fish-oil"</span>) <span class="sc">~</span> <span class="st">"fish"</span>,</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"fishmeal"</span>) <span class="sc">~</span> <span class="st">"fish"</span>,</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"krill"</span>) <span class="sc">~</span> <span class="st">"other-marine"</span>,</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"soy"</span>) <span class="sc">~</span> <span class="st">"legume"</span>,</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"pea"</span>) <span class="sc">~</span> <span class="st">"legume"</span>,</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"guar"</span>) <span class="sc">~</span> <span class="st">"legume"</span>,</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"faba"</span>) <span class="sc">~</span> <span class="st">"legume"</span>,</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"corn"</span>) <span class="sc">~</span> <span class="st">"wheat-corn"</span>,</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"wheat"</span>) <span class="sc">~</span> <span class="st">"wheat-corn"</span>,</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"chicken"</span>) <span class="sc">~</span> <span class="st">"chicken"</span>,</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"bacteri"</span>) <span class="sc">~</span> <span class="st">"bact-fungi-micro"</span>,</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"yeast"</span>) <span class="sc">~</span> <span class="st">"bact-fungi-micro"</span>,</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"spirulina"</span>) <span class="sc">~</span> <span class="st">"bact-fungi-micro"</span>,</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(ingredient, <span class="st">"bsf"</span>) <span class="sc">~</span> <span class="st">"insect"</span>,</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>      T <span class="sc">~</span> <span class="st">"other-plant"</span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"fish"</span>, <span class="st">"other-marine"</span>, <span class="st">"chicken"</span>, <span class="st">"wheat-corn"</span>, <span class="st">"legume"</span>, <span class="st">"other-plant"</span>, <span class="st">"insect"</span>, <span class="st">"bact-fungi-micro"</span>))</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>p_ings <span class="ot">&lt;-</span> feed_ings <span class="sc">%&gt;%</span> </span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">feed =</span> <span class="fu">factor</span>(feed, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"reference"</span>, <span class="st">"past"</span>, <span class="st">"future"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Reference"</span>, <span class="st">"Past"</span>, <span class="st">"Future"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(feed, category) <span class="sc">%&gt;%</span></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">proportion =</span> <span class="fu">sum</span>(proportion)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> proportion, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Ingredient category"</span>,</span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"fish"</span> <span class="ot">=</span> <span class="st">"royalblue3"</span>, <span class="st">"other-marine"</span> <span class="ot">=</span> <span class="st">"turquoise2"</span>, <span class="st">"chicken"</span> <span class="ot">=</span> <span class="st">"hotpink1"</span>, <span class="st">"wheat-corn"</span> <span class="ot">=</span> <span class="st">"moccasin"</span>, <span class="st">"legume"</span> <span class="ot">=</span> <span class="st">"forestgreen"</span>, <span class="st">"other-plant"</span> <span class="ot">=</span> <span class="st">"darkolivegreen1"</span>, <span class="st">"insect"</span> <span class="ot">=</span> <span class="st">"firebrick3"</span>, <span class="st">"bact-fungi-micro"</span> <span class="ot">=</span> <span class="st">"darkorange"</span>), </span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Fish meal or oil"</span>, <span class="st">"Other marine ingredients"</span>, <span class="st">"Chicken"</span>, <span class="st">"Wheat and corn"</span>, <span class="st">"Legumes"</span>, <span class="st">"Other plant ingredients"</span>, <span class="st">"Insects"</span>, <span class="st">"Bacteria, fungi or microalgae"</span>)) <span class="sc">+</span></span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(feed)) <span class="sc">+</span></span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>)</span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p_ings, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-feed-summary-ideas" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-feed-summary-ideas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="manuscript_files/figure-html/fig-feed-summary-ideas-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;2: Ideas for how to present the differences between feeds. Top plot shows the protein (red), lipids (yellow) and carbohydrate (blue) composition, with the digestible portion shown darker and the undigestible portion shown lighter. Bottom plot shows the proportion of each feed composed of each types of ingredient."><img src="manuscript_files/figure-html/fig-feed-summary-ideas-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="816"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-feed-summary-ideas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Ideas for how to present the differences between feeds. Top plot shows the protein (red), lipids (yellow) and carbohydrate (blue) composition, with the digestible portion shown darker and the undigestible portion shown lighter. Bottom plot shows the proportion of each feed composed of each types of ingredient.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
<section id="model-population-and-biomass" class="level2">
<h2 class="anchored" data-anchor-id="model-population-and-biomass">Model population and biomass</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>farmrun_files <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_cohort_growth_data_path) <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="at">full.names =</span> T)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(farmrun_files, <span class="cf">function</span>(f) {qs<span class="sc">::</span><span class="fu">qread</span>(f)[[<span class="st">"weight_stat"</span>]]}) <span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>biomass <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(farmrun_files, <span class="cf">function</span>(f) {qs<span class="sc">::</span><span class="fu">qread</span>(f)[[<span class="st">"biomass_stat"</span>]]}) <span class="sc">%&gt;%</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [12]:</pre></div><div id="cell-fig-cohorts" class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>fnms <span class="ot">&lt;-</span> output_farm_growth_data_path <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_subset</span>(<span class="st">"reference"</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> qs<span class="sc">::</span><span class="fu">qread</span>(fnms[<span class="dv">1</span>])[[<span class="st">"biomass_stat"</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean =</span> <span class="fu">set_units</span>(mean, <span class="st">"g"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"t"</span>),</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> <span class="fu">set_units</span>(sd, <span class="st">"g"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"t"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>farm_ID)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">cohort =</span> <span class="dv">1</span>),</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">t =</span> t<span class="sc">+</span><span class="dv">365</span>, <span class="at">cohort =</span> <span class="dv">2</span>),</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">t =</span> t<span class="sc">+</span><span class="dv">730</span>, <span class="at">cohort =</span> <span class="dv">3</span>)</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">t =</span> (t<span class="sc">-</span><span class="fu">min</span>(t))<span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">split =</span> <span class="st">"Split by cohort"</span>)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>min_t <span class="ot">&lt;-</span> <span class="fu">min</span>(df<span class="sc">$</span>t[df<span class="sc">$</span>cohort <span class="sc">==</span> <span class="dv">2</span>])</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>max_t <span class="ot">&lt;-</span> <span class="fu">max</span>(df<span class="sc">$</span>t[df<span class="sc">$</span>cohort <span class="sc">==</span> <span class="dv">2</span>])</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>df_2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(t <span class="sc">%in%</span> min_t<span class="sc">:</span>max_t) <span class="sc">%&gt;%</span> </span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sd =</span> sd<span class="sc">/</span>mean) <span class="sc">%&gt;%</span> </span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(t) <span class="sc">%&gt;%</span> </span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(sd<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">sum</span>(mean),</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd =</span> sd<span class="sc">*</span>mean) <span class="sc">%&gt;%</span> </span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cohort =</span> <span class="st">"all"</span>,</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">split =</span> <span class="st">"Totalled"</span>)</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df, df_2) <span class="sc">%&gt;%</span> </span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cohort =</span> <span class="fu">as.factor</span>(cohort))</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> mean, <span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd, <span class="at">colour =</span> <span class="fu">as.factor</span>(cohort))) <span class="sc">+</span></span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(split)) <span class="sc">+</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1600</span>, <span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> cohort_pal) <span class="sc">+</span></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>() <span class="sc">+</span></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Farm biomass"</span>, <span class="at">x =</span> <span class="st">"Day of production"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-cohorts" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cohorts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="manuscript_files/figure-html/fig-cohorts-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;3: Example of how the overlapping cohorts combine into a single farm production curve (in this case biomass). The left plot shows the farm biomass produced by each cohort from initialisation to harvest, while the right plot shows the combined farm biomass over the course of a single production period of 548 days."><img src="manuscript_files/figure-html/fig-cohorts-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="816"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cohorts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Example of how the overlapping cohorts combine into a single farm production curve (in this case biomass). The left plot shows the farm biomass produced by each cohort from initialisation to harvest, while the right plot shows the combined farm biomass over the course of a single production period of 548 days.
</figcaption>
</figure>
</div>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [13]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>coho_biom <span class="ot">&lt;-</span> <span class="fu">file.path</span>(data_analysis_path, <span class="st">"biomass_produced_comparison.qs"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  qs<span class="sc">::</span><span class="fu">qread</span>()</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>harv_size <span class="ot">&lt;-</span> <span class="fu">file.path</span>(output_farm_data_path, <span class="st">"farm_harvest_size.qs"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qread</span>()</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>coho_biom_summ <span class="ot">&lt;-</span> coho_biom <span class="sc">%&gt;%</span> </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc_diff =</span> <span class="dv">100</span><span class="sc">*</span>(mean <span class="sc">-</span> tonnes_per_farm)<span class="sc">/</span>tonnes_per_farm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Each farm’s final population was calculated by dividing the production tonnage required by the average modelled individual harvest size for each farm (when feed reference feed). A population timeseries was the generated using the standard mortality rate (5.99798^{-4} d<span class="math inline">\(^{-1}\)</span>). Using this method, a farm’s ‘population’ is not a good representation of the actual number of individuals being farmed, but it ensures each farm location is producing the correct tonnage while allowing comparisons between the different feeds.</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [14]:</pre></div><div id="cell-fig-harvest-size" class="cell" data-layout-align="center">
<div class="margin-aside">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>harv_size <span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight =</span> weight <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"kg"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(farm_ID, weight)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight)) <span class="sc">+</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.25</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"salmon"</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">500</span>)) <span class="sc">+</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency"</span>, <span class="at">x =</span> <span class="st">"Harvest weight"</span>) <span class="sc">+</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>() <span class="sc">+</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="fl">0.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-harvest-size" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-harvest-size-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="manuscript_files/figure-html/fig-harvest-size-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;4: Frequency distribution of harvest sizes used to create the population timeseries for each farm, as predicted by the fish-growth model."><img src="manuscript_files/figure-html/fig-harvest-size-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="816"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-harvest-size-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Frequency distribution of harvest sizes used to create the population timeseries for each farm, as predicted by the fish-growth model.
</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
<p>By this method, farm biomass as predicted by the model slightly overestimated farm tonnage. Predicted farm biomass was 2.4-6.5 higher than tonnage produced (<a href="#fig-biomass-produced" class="quarto-xref">Figure&nbsp;6</a>). This variation was not correlated with mean farm temperature or total tonnage produced (<a href="#fig-biomass-variation" class="quarto-xref">Figure&nbsp;5</a>).</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [15]:</pre></div><div id="cell-fig-biomass-variation" class="cell" data-layout-align="center">
<div class="margin-aside">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coho_biom_summ<span class="sc">$</span>temp_c, coho_biom_summ<span class="sc">$</span>perc_diff)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(coho_biom_summ$tonnes_per_farm, coho_biom_summ$perc_diff)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-biomass-variation" class="quarto-float quarto-figure quarto-figure-center anchored" width="816" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-biomass-variation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="manuscript_files/figure-html/fig-biomass-variation-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;5: "><img src="manuscript_files/figure-html/fig-biomass-variation-1.png" id="fig-biomass-variation" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" width="816"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-biomass-variation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5
</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [16]:</pre></div><div id="cell-fig-biomass-produced" class="cell" data-layout-align="center">
<div class="margin-aside">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>coho_biom <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tonnes_per_farm, <span class="at">y =</span> mean, <span class="at">colour =</span> country)) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1700</span>)) <span class="sc">+</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1700</span>)) <span class="sc">+</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Modelled biomass produced (t)"</span>, <span class="at">x =</span> <span class="st">"Observed biomass produced (t)"</span>) <span class="sc">+</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>() <span class="sc">+</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 20 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-biomass-produced" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-biomass-produced-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="manuscript_files/figure-html/fig-biomass-produced-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;6: Modelled vs observed salmon biomass produced"><img src="manuscript_files/figure-html/fig-biomass-produced-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="816"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-biomass-produced-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Modelled vs observed salmon biomass produced
</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="impacts-of-nutrient-input" class="level2">
<h2 class="anchored" data-anchor-id="impacts-of-nutrient-input">Impacts of nutrient input</h2>
<p><em>To detail here:</em></p>
<ul>
<li>How to convert feed and uneaten faeces into nutrients - just nitrogen? Carbon too? If just nitrogen, then can probably use the standard N = 6.25 x protein conversion to compare the feeds (lipids and carbohydrates have negligible protein). If doing carbon too, will need to find conversion rates for all of them, possibly splitting carbs/lipids into complex/simple, saturated/unsaturated, etc.</li>
<li>Source of species vulnerability layers</li>
</ul>
</section>
</section>
<section id="statistical-analysis-code-availability" class="level1">
<h1>Statistical analysis &amp; code availability</h1>
<p>All analysis was conducted in R version 4.4.2 “Pile of Leaves” <span class="citation" data-cites="R_base">(<a href="#ref-R_base" role="doc-biblioref">R Core Team 2019</a>)</span>. Major packages used include packages <code>magrittr</code>, version 2.0.3 <span class="citation" data-cites="magrittr">(<a href="#ref-magrittr" role="doc-biblioref">Bache and Wickham 2022</a>)</span>, <code>dplyr</code>, version 1.1.4 <span class="citation" data-cites="dplyr">(<a href="#ref-dplyr" role="doc-biblioref">Wickham et al. 2023</a>)</span>, <code>tidyr</code>, version 1.3.1 <span class="citation" data-cites="tidyr">(<a href="#ref-tidyr" role="doc-biblioref">Wickham, Vaughan, and Girlich 2024</a>)</span>, <code>stringr</code>, version 1.5.1 <span class="citation" data-cites="stringr">(<a href="#ref-stringr" role="doc-biblioref">Wickham 2023</a>)</span>, <code>ggplot2</code>, version 3.5.2 <span class="citation" data-cites="ggplot2">(<a href="#ref-ggplot2" role="doc-biblioref">Wickham 2016</a>)</span>, <code>arrow</code>, version 20.0.0.2 <span class="citation" data-cites="arrow">(<a href="#ref-arrow" role="doc-biblioref">Richardson et al. 2024</a>)</span>, <code>targets</code>, version 1.11.3 <span class="citation" data-cites="targets">(<a href="#ref-targets" role="doc-biblioref">Landau 2021</a>)</span>, <code>sf</code>, version 1.0.21 <span class="citation" data-cites="sf">(<a href="#ref-sf" role="doc-biblioref">Pebesma 2018</a>)</span>, <code>terra</code>, version 1.8.54 <span class="citation" data-cites="terra">(<a href="#ref-terra" role="doc-biblioref">Hijmans 2024</a>)</span>, <code>rnaturalearth</code>, version 1.1.0 <span class="citation" data-cites="rnaturalearth">(<a href="#ref-rnaturalearth" role="doc-biblioref">Massicotte and South, n.d.</a>)</span>, <code>furrr</code>, version 0.3.1 <span class="citation" data-cites="furrr">(<a href="#ref-furrr" role="doc-biblioref">Vaughan and Dancho 2022</a>)</span>, <code>future</code>, version 1.58.0 <span class="citation" data-cites="future">(<a href="#ref-future" role="doc-biblioref">Bengtsson 2021</a>)</span>, <code>units</code>, version 0.8.7 <span class="citation" data-cites="units">(<a href="#ref-units" role="doc-biblioref">Pebesma, Mailund, and Hiebert 2016</a>)</span>, and <code>lubridate</code>, version 1.9.4 <span class="citation" data-cites="lubridate">(<a href="#ref-lubridate" role="doc-biblioref">Grolemund and Wickham 2011</a>)</span>. For a full list of R packages used see the lockfile on <a href="https://www.github.com">Github</a>. This manuscript was written in Quarto <span class="citation" data-cites="quarto">(<a href="#ref-quarto" role="doc-biblioref">Allaire et al. 2024</a>)</span> using TinyTex <span class="citation" data-cites="tinytex">(<a href="#ref-tinytex" role="doc-biblioref">Xie 2017</a>)</span> and the acronyms extension <span class="citation" data-cites="acronyms">(<a href="#ref-acronyms" role="doc-biblioref">Chaput 2024</a>)</span>.</p>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<ul>
<li>Parameter sensitivity results are in supplementary <a href="#sec-parameter-sensitivity" class="quarto-xref">Section&nbsp;4.1</a></li>
</ul>
<p>In general, data outputs comes in the following dimensions:</p>
<ul>
<li>Location -&gt; temperature -&gt; farm_ID</li>
<li>Uneaten feed + excreted faeces = total inputs (g)</li>
<li>Day of production (impacted by location)</li>
<li>Main point is the difference between feeds (kg/t salmon).</li>
<li>Also interesting to see if difference between feeds varies geographically (correlates with latitude, or maybe mean/median/max temperature?)</li>
</ul>
<section id="uneaten-feed" class="level2">
<h2 class="anchored" data-anchor-id="uneaten-feed">Uneaten feed</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [17]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Load and prep uneaten feed data</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>uneaten_total <span class="ot">&lt;-</span> farmrun_files <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(f) {qs<span class="sc">::</span><span class="fu">qread</span>(f)[[<span class="st">"total_uneat_stat"</span>]]}) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(biomass, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"farm_ID"</span>, <span class="st">"feed"</span>, <span class="st">"t"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">uneat_mean =</span> mean.x, <span class="at">biomass_mean =</span> mean.y,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">uneat_sd =</span> sd.x, <span class="at">biomass_sd =</span> sd.y) <span class="sc">%&gt;%</span> </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">uneat_sd =</span> uneat_sd<span class="sc">/</span>uneat_mean,</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">biomass_sd =</span> biomass_sd<span class="sc">/</span>biomass_mean,</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">uneat_biom_mean =</span> uneat_mean<span class="sc">/</span>biomass_mean,</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">uneat_biom_sd =</span> <span class="fu">sqrt</span>(uneat_sd<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>biomass_sd<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>uneat_biom_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [18]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>uneaten_total_stats <span class="ot">&lt;-</span> uneaten_total <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(feed, farm_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">total =</span> <span class="fu">sum</span>(uneat_biom_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(feed) <span class="sc">%&gt;%</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">min =</span> <span class="fu">minna</span>(total),</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">max =</span> <span class="fu">maxna</span>(total),</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">meanna</span>(total)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">min =</span> min <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g g_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g kg_fish-1"</span>),</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">max =</span> max <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g g_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g kg_fish-1"</span>),</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> mean <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g g_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g kg_fish-1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">min =</span> <span class="fu">round</span>(min,<span class="dv">2</span>),</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">max =</span> <span class="fu">round</span>(max,<span class="dv">2</span>),</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">round</span>(mean,<span class="dv">2</span>))</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>uneaten_total_compare <span class="ot">&lt;-</span> uneaten_total <span class="sc">%&gt;%</span> </span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(feed, farm_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">total =</span> <span class="fu">sum</span>(uneat_biom_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"feed"</span>, <span class="at">values_from =</span> <span class="st">"total"</span>, <span class="at">id_cols =</span> <span class="st">"farm_ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff_past =</span> past<span class="sc">-</span>reference,</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">diff_future =</span> future<span class="sc">-</span>reference,</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">diffperc_past =</span> diff_past<span class="sc">/</span>reference,</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">diffperc_future =</span> diff_future<span class="sc">/</span>reference) <span class="sc">%&gt;%</span> </span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(reference, future, past)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"measure"</span>, <span class="st">"feed"</span>), <span class="at">names_sep =</span> <span class="st">"_"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>,</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"diff"</span>), <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">measure =</span> as.factor, <span class="at">feed =</span> as.factor)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(feed, measure) <span class="sc">%&gt;%</span> </span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">min =</span> <span class="fu">minna</span>(value),</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">max =</span> <span class="fu">maxna</span>(value),</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">meanna</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">case_when</span>(measure <span class="sc">==</span> <span class="st">"diffperc"</span> <span class="sc">~</span> <span class="dv">100</span><span class="sc">*</span>min,</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>                    T <span class="sc">~</span> min <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g g_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g kg_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">drop_units</span>()),</span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">case_when</span>(measure <span class="sc">==</span> <span class="st">"diffperc"</span> <span class="sc">~</span> <span class="dv">100</span><span class="sc">*</span>max,</span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>                    T <span class="sc">~</span> max <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g g_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g kg_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">drop_units</span>()),</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">case_when</span>(measure <span class="sc">==</span> <span class="st">"diffperc"</span> <span class="sc">~</span> <span class="dv">100</span><span class="sc">*</span>mean,</span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>                     T <span class="sc">~</span> mean <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g g_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g kg_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">drop_units</span>()),</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>Total uneaten feed across a cohort (548 days) fed the reference feed ranged from 48.46 to 73.82 g kg<span class="math inline">\(^{-1}\)</span> fish, with a mean of 61.71 g kg<span class="math inline">\(^{-1}\)</span> fish. Differences between the feeds were very small, but slightly less feed was left uneaten in the reference scenario (<a href="#fig-total-uneaten-perday" class="quarto-xref">Figure&nbsp;7</a>). Uneaten feed in the past scenario ranged from 48.72 to 74.52 g kg<span class="math inline">\(^{-1}\)</span> fish (mean of 62.17 g kg<span class="math inline">\(^{-1}\)</span> fish) while uneaten feed in the future scenario ranged from 48.73 to 74.25 g kg<span class="math inline">\(^{-1}\)</span> (mean of 62.05 g kg<span class="math inline">\(^{-1}\)</span> fish).</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [19]:</pre></div><div id="cell-fig-total-uneaten-perday" class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>uneaten_total <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(farms_geometry, <span class="at">by =</span> <span class="st">"farm_ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">uneat_biom_mean =</span> uneat_biom_mean <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g g_fish-1 d-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g kg_fish-1 d-1"</span>),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">country =</span> <span class="fu">factor</span>(country, <span class="at">levels =</span> sorted_countries)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> uneat_biom_mean, <span class="at">fill =</span> feed)) <span class="sc">+</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>() <span class="sc">+</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> feed_pal) <span class="sc">+</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Uneaten feed"</span>, <span class="at">x =</span> <span class="st">"Country"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-total-uneaten-perday" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-total-uneaten-perday-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="manuscript_files/figure-html/fig-total-uneaten-perday-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;7: Feed left uneaten when fish are fed the reference (blue), past (red) or future (green) feed. Countries are arranged by descending mean latitude."><img src="manuscript_files/figure-html/fig-total-uneaten-perday-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="816"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-total-uneaten-perday-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Feed left uneaten when fish are fed the reference (blue), past (red) or future (green) feed. Countries are arranged by descending mean latitude.
</figcaption>
</figure>
</div>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [20]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>uneaten_P <span class="ot">&lt;-</span> farmrun_files <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(f) {qs<span class="sc">::</span><span class="fu">qread</span>(f)[[<span class="st">"P_uneat_stat"</span>]]}) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>uneaten_L <span class="ot">&lt;-</span> farmrun_files <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(f) {qs<span class="sc">::</span><span class="fu">qread</span>(f)[[<span class="st">"L_uneat_stat"</span>]]}) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>uneaten_C <span class="ot">&lt;-</span> farmrun_files <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(f) {qs<span class="sc">::</span><span class="fu">qread</span>(f)[[<span class="st">"C_uneat_stat"</span>]]}) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>uneaten_all <span class="ot">&lt;-</span> uneaten_total <span class="sc">%&gt;%</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"biom"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(uneaten_P, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"farm_ID"</span>, <span class="st">"feed"</span>, <span class="st">"t"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(uneaten_L, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"farm_ID"</span>, <span class="st">"feed"</span>, <span class="st">"t"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(uneaten_C, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"farm_ID"</span>, <span class="st">"feed"</span>, <span class="st">"t"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="fu">contains</span>(<span class="st">"sd"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>The composition of the uneaten feed is (obviously) the same as the total feed composition detailed in (<a href="#sec-feeds" class="quarto-xref">Section&nbsp;1.4</a>).</p>
</section>
<section id="excreted-faeces" class="level2">
<h2 class="anchored" data-anchor-id="excreted-faeces">Excreted faeces</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [21]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Load and prep all excretion data</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following reads in all the total excretion data and converts the mean and sd values into values/biomass</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>excreted_total <span class="ot">&lt;-</span> farmrun_files <span class="sc">%&gt;%</span> </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(f) {qs<span class="sc">::</span><span class="fu">qread</span>(f)[[<span class="st">"total_excr_stat"</span>]]}) <span class="sc">%&gt;%</span> </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(biomass, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"farm_ID"</span>, <span class="st">"feed"</span>, <span class="st">"t"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">excr_mean =</span> mean.x, <span class="at">biomass_mean =</span> mean.y,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">excr_sd =</span> sd.x, <span class="at">biomass_sd =</span> sd.y) <span class="sc">%&gt;%</span> </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">excr_sd =</span> excr_sd<span class="sc">/</span>excr_mean,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">biomass_sd =</span> biomass_sd<span class="sc">/</span>biomass_mean,</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">excr_biom_mean =</span> excr_mean<span class="sc">/</span>biomass_mean,</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">excr_biom_sd =</span> <span class="fu">sqrt</span>(excr_sd<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>biomass_sd<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>excr_biom_mean)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>excreted_total_stats <span class="ot">&lt;-</span> excreted_total <span class="sc">%&gt;%</span> </span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(feed, farm_ID) <span class="sc">%&gt;%</span> </span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">total =</span> <span class="fu">sum</span>(excr_biom_mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(feed) <span class="sc">%&gt;%</span> </span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">min =</span> <span class="fu">minna</span>(total),</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">max =</span> <span class="fu">maxna</span>(total),</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">meanna</span>(total)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">min =</span> min <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g g_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g kg_fish-1"</span>),</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">max =</span> max <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g g_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g kg_fish-1"</span>),</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> mean <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g g_fish-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g kg_fish-1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">min =</span> <span class="fu">round</span>(min,<span class="dv">2</span>),</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">max =</span> <span class="fu">round</span>(max,<span class="dv">2</span>),</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">round</span>(mean,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<section id="amount" class="level3">
<h3 class="anchored" data-anchor-id="amount">Amount</h3>
<p>Overall, total excretion was lowest when when fish were fed the past feed and highest when fish were fed the reference feed (<a href="#fig-total-excreted-perday" class="quarto-xref">Figure&nbsp;8</a>). Total excreted faeces across a cohort (548 days) in the reference scenario ranged from 194.24 to 295.9 g kg<span class="math inline">\(^{-1}\)</span> fish d<span class="math inline">\(^{-1}\)</span>, with a mean of 247.38. Total excreted faeces across a cohort in the past scenario ranged from 154.33 to 236.05 g kg<span class="math inline">\(^{-1}\)</span> fish d<span class="math inline">\(^{-1}\)</span> (mean of 196.94 g kg<span class="math inline">\(^{-1}\)</span> fish d<span class="math inline">\(^{-1}\)</span>). Total excreted faeces across a cohort in the future scenario ranged from 202.55 to 308.61 g kg<span class="math inline">\(^{-1}\)</span> fish d<span class="math inline">\(^{-1}\)</span> (mean of 257.91 g kg<span class="math inline">\(^{-1}\)</span> fish d<span class="math inline">\(^{-1}\)</span>).</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [22]:</pre></div><div id="cell-fig-total-excreted-perday" class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>excreted_total <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(farms_geometry, <span class="at">by =</span> <span class="st">"farm_ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">excr_biom_mean =</span> excr_biom_mean <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g g_fish-1 d-1"</span>) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"g kg_fish-1 d-1"</span>),</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">country =</span> <span class="fu">factor</span>(country, <span class="at">levels =</span> sorted_countries)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> excr_biom_mean, <span class="at">fill =</span> feed)) <span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>() <span class="sc">+</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> feed_pal) <span class="sc">+</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Excreted faeces"</span>, <span class="at">x =</span> <span class="st">"Country"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-total-excreted-perday" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-total-excreted-perday-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="manuscript_files/figure-html/fig-total-excreted-perday-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;8: Feed left uneaten when fish are fed the reference (blue), past (red) or future (green) feed. Countries are arranged by descending mean latitude."><img src="manuscript_files/figure-html/fig-total-excreted-perday-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="816"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-total-excreted-perday-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Feed left uneaten when fish are fed the reference (blue), past (red) or future (green) feed. Countries are arranged by descending mean latitude.
</figcaption>
</figure>
</div>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [23]:</pre></div><div id="cell-fig-total-excr-diff_perc" class="cell" data-layout-align="center">
<div class="margin-aside">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> excreted_total <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"sd"</span>, <span class="st">"biom"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"feed"</span>, <span class="at">values_from =</span> <span class="st">"excr_mean"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">past =</span> past<span class="sc">-</span>reference,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">future =</span> future<span class="sc">-</span>reference) <span class="sc">%&gt;%</span> </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"feed"</span>, <span class="at">values_to =</span> <span class="st">"diff"</span>, <span class="at">cols =</span> <span class="fu">c</span>(past, future), <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">feed =</span> as.factor)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">reference =</span> <span class="fu">set_units</span>(reference, <span class="st">"g kg_fish-1 d-1"</span>),</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">diff_perc =</span> <span class="fu">drop_units</span>(diff<span class="sc">/</span>reference)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">merge</span>(farm_coords, <span class="at">by =</span> <span class="st">"farm_ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prod_day =</span> t <span class="sc">-</span> t_start <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>summ <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hemisphere, feed) <span class="sc">%&gt;%</span> </span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">mean =</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">meanna</span>(diff_perc) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>),</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">min =</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">meanna</span>(diff_perc) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>),</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">max =</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">maxna</span>(diff_perc) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>))</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> reference, <span class="at">y =</span> diff_perc, <span class="at">colour =</span> hemisphere)) <span class="sc">+</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>feed) <span class="sc">+</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>()</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a><span class="co"># The difference in total excretion for the past feed ranged from </span></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a><span class="co"># `r summ$min[summ$feed == "past"]`-`r summ$max[summ$feed == "past"]`% across all farms globally, and for the future feed ranged from </span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a><span class="co"># `r summ$min[summ$feed == "future"]`-`r summ$max[summ$feed == "future"]`%. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [24]:</pre></div><div id="cell-fig-total-excr-diff_perc_2" class="cell" data-layout-align="center">
<div class="margin-aside">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(prod_day, feed, hemisphere) <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">diff_perc_mean =</span> <span class="fu">meanna</span>(diff_perc),</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">diff_perc_sd =</span> <span class="fu">sdna</span>(diff_perc)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> prod_day, <span class="at">y =</span> diff_perc_mean, <span class="at">ymin =</span> diff_perc_mean<span class="sc">-</span>diff_perc_sd, <span class="at">ymax =</span> diff_perc_mean<span class="sc">+</span>diff_perc_sd, </span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="fu">as.factor</span>(hemisphere), <span class="at">fill =</span> <span class="fu">as.factor</span>(hemisphere))) <span class="sc">+</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>feed) <span class="sc">+</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div></div>
<p>However, the actual difference in excreted faeces varied by feed, time in the production cycle, and location of the farm <strong>?@fig-total-excr-act_diff</strong>.</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [25]:</pre></div><div id="cell-fig-total-excr-act_diff" class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> excreted_total <span class="sc">%&gt;%</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"sd"</span>, <span class="st">"excr_mean"</span>, <span class="st">"biomass"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"feed"</span>, <span class="at">values_from =</span> <span class="st">"excr_biom_mean"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">past =</span> past<span class="sc">-</span>reference,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">future =</span> future<span class="sc">-</span>reference) <span class="sc">%&gt;%</span> </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"feed"</span>, <span class="at">values_to =</span> <span class="st">"diff"</span>, <span class="at">cols =</span> <span class="fu">c</span>(past, future), <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">feed =</span> as.factor)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">reference =</span> <span class="fu">set_units</span>(reference, <span class="st">"g kg_fish-1 d-1"</span>),</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">diff =</span> <span class="fu">set_units</span>(diff, <span class="st">"kg t_fish-1 d-1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(farm_coords, <span class="at">by =</span> <span class="st">"farm_ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prod_day =</span> t<span class="sc">-</span>t_start<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>summ <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hemisphere, feed) <span class="sc">%&gt;%</span> </span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">mean =</span> <span class="fu">meanna</span>(diff) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>),</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">min =</span> <span class="fu">meanna</span>(diff) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>),</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">max =</span> <span class="fu">maxna</span>(diff) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>))</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hemisphere, feed, prod_day) <span class="sc">%&gt;%</span> </span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">mean_diff =</span> <span class="fu">meanna</span>(diff),</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">sd_diff =</span> <span class="fu">sdna</span>(diff) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"kg t_fish-1 d-1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> prod_day, <span class="at">y =</span> mean_diff, <span class="at">ymin =</span> mean_diff<span class="sc">-</span>sd_diff, <span class="at">ymax =</span> mean_diff<span class="sc">+</span>sd_diff, <span class="at">colour =</span> hemisphere, <span class="at">fill =</span> hemisphere)) <span class="sc">+</span></span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>feed) <span class="sc">+</span></span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
</section>
<section id="composition" class="level3">
<h3 class="anchored" data-anchor-id="composition">Composition</h3>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [26]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>excreted_P <span class="ot">&lt;-</span> farmrun_files <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(f) {qs<span class="sc">::</span><span class="fu">qread</span>(f)[[<span class="st">"P_excr_stat"</span>]]}) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>excreted_L <span class="ot">&lt;-</span> farmrun_files <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(f) {qs<span class="sc">::</span><span class="fu">qread</span>(f)[[<span class="st">"L_excr_stat"</span>]]}) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>excreted_C <span class="ot">&lt;-</span> farmrun_files <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(f) {qs<span class="sc">::</span><span class="fu">qread</span>(f)[[<span class="st">"C_excr_stat"</span>]]}) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>()</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>excreted_all <span class="ot">&lt;-</span> excreted_total <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"biom"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(excreted_P, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"farm_ID"</span>, <span class="st">"feed"</span>, <span class="st">"t"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(excreted_L, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"farm_ID"</span>, <span class="st">"feed"</span>, <span class="st">"t"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(excreted_C, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"farm_ID"</span>, <span class="st">"feed"</span>, <span class="st">"t"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="fu">contains</span>(<span class="st">"sd"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">protein =</span> mean.x, <span class="at">lipids =</span> mean.y, <span class="at">carbohydrates =</span> mean) <span class="sc">%&gt;%</span> </span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">protein =</span> protein<span class="sc">/</span>excr_mean <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"d-1"</span>),</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">lipids =</span> lipids<span class="sc">/</span>excr_mean <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"d-1"</span>),</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">carbohydrates =</span> carbohydrates<span class="sc">/</span>excr_mean <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"d-1"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>excr_mean)</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>ec <span class="ot">&lt;-</span> excreted_all <span class="sc">%&gt;%</span> </span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(feed) <span class="sc">%&gt;%</span> </span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">P =</span> <span class="fu">mean</span>(protein),</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">C =</span> <span class="fu">mean</span>(carbohydrates),</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">L =</span> <span class="fu">mean</span>(lipids)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="st">"excreted"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(<span class="fu">data.frame</span>(</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">feed =</span> <span class="fu">c</span>(<span class="st">"reference"</span>, <span class="st">"past"</span>, <span class="st">"future"</span>),</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">P =</span> <span class="fu">c</span>(tP_1, tP_2, tP_3),</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">C =</span> <span class="fu">c</span>(tC_1, tC_2, tC_3),</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">L =</span> <span class="fu">c</span>(tL_1, tL_2, tL_3),</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">source =</span> <span class="fu">rep</span>(<span class="st">"feed"</span>, <span class="dv">3</span>)</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(P,L,C), <span class="at">names_to =</span> <span class="st">"macro"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>, </span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">macro =</span> as.factor), <span class="at">values_transform =</span> <span class="fu">list</span>(<span class="at">value =</span> as.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">source =</span> <span class="fu">factor</span>(source, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"feed"</span>, <span class="st">"excreted"</span>)),</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">macro =</span> <span class="fu">factor</span>(macro, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"P"</span>, <span class="st">"L"</span>, <span class="st">"C"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Protein"</span>, <span class="st">"Lipids"</span>, <span class="st">"Carbohydrates"</span>)),</span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">feed =</span> <span class="fu">factor</span>(feed, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"reference"</span>, <span class="st">"past"</span>, <span class="st">"future"</span>)),</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">source =</span> <span class="fu">factor</span>(source, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"feed"</span>, <span class="st">"excreted"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Feed"</span>, <span class="st">"Faeces"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<div class=""><p>Unlike the uneaten feed, the composition of excreted faeces differs from that of the incoming feed. </p><div class="no-row-height"><span class="margin-aside">Note that composition does not change through time or with increasing biomass (because digestibility does not change with fish size or temeprature)</span></div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [27]:</pre></div><div class="cell" data-layout-align="center">
<div class="margin-aside">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>excreted_all <span class="sc">%&gt;%</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"macro"</span>, <span class="at">values_to =</span> <span class="st">"perc"</span>, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"protein"</span>, <span class="st">"lipids"</span>, <span class="st">"carbohydrates"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">macro =</span> <span class="fu">factor</span>(macro, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"protein"</span>, <span class="st">"lipids"</span>, <span class="st">"carbohydrates"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(farm_ID, feed, macro) <span class="sc">%&gt;%</span> </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="at">sd =</span> <span class="fu">sd</span>(perc) <span class="sc">%&gt;%</span> <span class="fu">set_units</span>(<span class="st">"d-1"</span>),</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean =</span> <span class="fu">mean</span>(perc)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> farm_ID, <span class="at">colour =</span> feed, <span class="at">fill =</span> feed, <span class="at">y =</span> <span class="dv">100</span><span class="sc">*</span>mean, <span class="at">ymin =</span> <span class="dv">100</span><span class="sc">*</span>(mean<span class="sc">-</span>sd), <span class="at">ymax =</span> <span class="dv">100</span><span class="sc">*</span>(mean<span class="sc">+</span>sd))) <span class="sc">+</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> feed_pal) <span class="sc">+</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> feed_pal) <span class="sc">+</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(macro)) <span class="sc">+</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Macronutrient"</span>, <span class="at">y =</span> <span class="st">"Mean composition of faeces"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div></div>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [28]:</pre></div><div id="cell-fig-composition-comparison" class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ec, <span class="fu">aes</span>(<span class="at">x =</span> source, <span class="at">y =</span> <span class="dv">100</span><span class="sc">*</span>value, <span class="at">fill =</span> feed)) <span class="sc">+</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(macro)) <span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>() <span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> feed_pal) <span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Composition (%)"</span>, <span class="at">x =</span> <span class="st">"Source"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-composition-comparison" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-composition-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="manuscript_files/figure-html/fig-composition-comparison-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;9: Comparison of the composition of the reference (blue), past (red) and future (green) feed and faeces of salmon fed each feed."><img src="manuscript_files/figure-html/fig-composition-comparison-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="816"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-composition-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Comparison of the composition of the reference (blue), past (red) and future (green) feed and faeces of salmon fed each feed.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
</section>
<section id="total-nutrients" class="level2">
<h2 class="anchored" data-anchor-id="total-nutrients">Total nutrients</h2>
</section>
</section>
<section id="supplementary-materials" class="level1">
<h1>Supplementary materials</h1>
<section id="sec-parameter-sensitivity" class="level2">
<h2 class="anchored" data-anchor-id="sec-parameter-sensitivity">Parameter sensitivity</h2>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [29]:</pre></div><div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>sens_weight <span class="ot">&lt;-</span> output_sens_data_path <span class="sc">%&gt;%</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_subset</span>(<span class="st">"results"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_subset</span>(<span class="st">"weight"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  qs<span class="sc">::</span><span class="fu">qread</span>()</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>sens_excr <span class="ot">&lt;-</span> output_sens_data_path <span class="sc">%&gt;%</span> </span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list.files</span>(<span class="at">full.names =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_subset</span>(<span class="st">"results"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_subset</span>(<span class="st">"total_excr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  qs<span class="sc">::</span><span class="fu">qread</span>() </span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>sens_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sens_weight, sens_excr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div></div>
<p>The most sensitive parameter by far in <a href="#fig-param-sens-weight" class="quarto-xref">Figure&nbsp;10</a> is <span class="math inline">\(m\)</span> (the weight exponent for anabolism), followed closely by <span class="math inline">\(n\)</span> the (weight exponent for catabolism). These two are also relatively uncertain, as <span class="math inline">\(m\)</span> was taken from <em>Salmo trutta</em> measurements in a fairly old paper <span class="citation" data-cites="broekhuizen_modelling_1994">(<a href="#ref-broekhuizen_modelling_1994" role="doc-biblioref">Broekhuizen et al. 1994</a>)</span> and <span class="math inline">\(n\)</span> was taken from <span class="citation" data-cites="baldan_r_2018">Baldan et al. (<a href="#ref-baldan_r_2018" role="doc-biblioref">2018</a>)</span> which did not specifically look at Atlantic salmon.</p>
<div class="cell-container code-fold"><div class="cell-decorator"><pre>In [30]:</pre></div><div id="cell-fig-param-sens-weight" class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>sens_data <span class="ot">&lt;-</span> sens_data <span class="sc">%&gt;%</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(measure <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"total_excr"</span>, <span class="st">"total_uneat"</span>)) </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>sens_data <span class="sc">%&gt;%</span> </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> adj_param, <span class="at">y =</span> mean_sens, <span class="at">ymin =</span> mean_sens <span class="sc">-</span> sd_sens, <span class="at">ymax =</span> mean_sens <span class="sc">+</span> sd_sens, <span class="at">fill =</span> measure)) <span class="sc">+</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">width =</span> <span class="fl">0.95</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_errorbar(position = position_dodge(width = 0.95), width = 0.3) +</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">30</span>,<span class="dv">5</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_discrete(limits = rev(param_names$name), labels = rev(param_names$lab)) +</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = c(total_excr = "salmon", total_uneat = "steelblue")) +</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Adjusted parameter"</span>, <span class="at">y =</span> <span class="st">"Sensitivity"</span>) <span class="sc">+</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prettyplot</span>() <span class="sc">+</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">aspect.ratio =</span> <span class="fl">0.8</span>,</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-param-sens-weight" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-param-sens-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="manuscript_files/figure-html/fig-param-sens-weight-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;10: Impact of increasing each model parameter by 10% on final farm biomass (red) and total excreted nutrients (blue) over the whole production period."><img src="manuscript_files/figure-html/fig-param-sens-weight-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="816"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-param-sens-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Impact of increasing each model parameter by 10% on final farm biomass (red) and total excreted nutrients (blue) over the whole production period.
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-quarto" class="csl-entry" role="listitem">
Allaire, J. J., Charles Teague, Carlos Scheidegger, Yihui Xie, and Christophe Dervieux. 2024. <span>‘<span>Quarto</span>’</span>. <a href="https://doi.org/10.5281/zenodo.5960048">https://doi.org/10.5281/zenodo.5960048</a>.
</div>
<div id="ref-magrittr" class="csl-entry" role="listitem">
Bache, Stefan Milton, and Hadley Wickham. 2022. <em>Magrittr: A Forward-Pipe Operator for r</em>. <a href="https://CRAN.R-project.org/package=magrittr">https://CRAN.R-project.org/package=magrittr</a>.
</div>
<div id="ref-baldan_r_2018" class="csl-entry" role="listitem">
Baldan, Damiano, Erika M. D. Porporato, Roberto Pastres, and Daniele Brigolin. 2018. <span>‘An <span>R</span> Package for Simulating Growth and Organic Wastage in Aquaculture Farms in Response to Environmental Conditions and Husbandry Practices’</span>. <em>PLOS ONE</em> 13 (5): e0195732. <a href="https://doi.org/10.1371/journal.pone.0195732">https://doi.org/10.1371/journal.pone.0195732</a>.
</div>
<div id="ref-future" class="csl-entry" role="listitem">
Bengtsson, Henrik. 2021. <span>‘A Unifying Framework for Parallel and Distributed Processing in r Using Futures’</span>. <em>The R Journal</em> 13 (2): 208–27. <a href="https://doi.org/10.32614/RJ-2021-048">https://doi.org/10.32614/RJ-2021-048</a>.
</div>
<div id="ref-broekhuizen_modelling_1994" class="csl-entry" role="listitem">
Broekhuizen, Niall., William. S. C. Gurney, A. Jones, and A. D. Bryant. 1994. <span>‘Modelling <span>Compensatory</span> <span>Growth</span>’</span>. <em>Functional Ecology</em> 8 (6): 770–82. <a href="https://doi.org/10.2307/2390237">https://doi.org/10.2307/2390237</a>.
</div>
<div id="ref-acronyms" class="csl-entry" role="listitem">
Chaput, Remy. 2024. <span>‘<span class="nocase">acronyms</span>’</span>. <a href="https://github.com/rchaput/acronyms">https://github.com/rchaput/acronyms</a>.
</div>
<div id="ref-cottrell_global_2020" class="csl-entry" role="listitem">
Cottrell, Richard S., Julia L. Blanchard, Benjamin S. Halpern, Marc Metian, and Halley E. Froehlich. 2020. <span>‘Global Adoption of Novel Aquaculture Feeds Could Substantially Reduce Forage Fish Demand by 2030’</span>. <em>Nature Food</em> 1 (5): 301–8. <a href="https://doi.org/10.1038/s43016-020-0078-x">https://doi.org/10.1038/s43016-020-0078-x</a>.
</div>
<div id="ref-cottrell_origins_nodate" class="csl-entry" role="listitem">
Cottrell, Richard S., Benjamin S. Halpern, Marceau Cormery, Helen A. Hamilton, Gage Clawson, Beth Penrose, Louise Adams, et al. n.d. <span>‘The Origins of Ingredients Matter More Than Ingredient Types for the Environmental Footprint of Aquaculture Feeds’</span>.
</div>
<div id="ref-dempsey_estimating_2023" class="csl-entry" role="listitem">
Dempsey, Danielle P., Gregor K. Reid, Leah Lewis-McCrea, Toby Balch, Roland Cusack, André Dumas, and Jack Rensel. 2023. <span>‘Estimating Stocking Weights for <span>Atlantic</span> Salmon to Grow to Market Size at Novel Aquaculture Sites with Extreme Temperatures’</span>. <em>Frontiers in Marine Science</em> 10 (May). <a href="https://doi.org/10.3389/fmars.2023.1094247">https://doi.org/10.3389/fmars.2023.1094247</a>.
</div>
<div id="ref-elliott_energy_1975" class="csl-entry" role="listitem">
Elliott, J. M., and W. Davison. 1975. <span>‘Energy Equivalents of Oxygen Consumption in Animal Energetics’</span>. <em>Oecologia</em> 19 (3): 195–201. <a href="https://doi.org/10.1007/BF00345305">https://doi.org/10.1007/BF00345305</a>.
</div>
<div id="ref-lubridate" class="csl-entry" role="listitem">
Grolemund, Garrett, and Hadley Wickham. 2011. <span>‘Dates and Times Made Easy with <span class="nocase">lubridate</span>’</span>. <em>Journal of Statistical Software</em> 40 (3): 1–25. <a href="https://www.jstatsoft.org/v40/i03/">https://www.jstatsoft.org/v40/i03/</a>.
</div>
<div id="ref-handeland_effect_2008" class="csl-entry" role="listitem">
Handeland, Sigurd O., Albert K. Imsland, and Sigurd O. Stefansson. 2008. <span>‘The Effect of Temperature and Fish Size on Growth, Feed Intake, Food Conversion Efficiency and Stomach Evacuation Rate of <span>Atlantic</span> Salmon Post-Smolts’</span>. <em>Aquaculture</em> 283 (1): 36–42. <a href="https://doi.org/10.1016/j.aquaculture.2008.06.042">https://doi.org/10.1016/j.aquaculture.2008.06.042</a>.
</div>
<div id="ref-terra" class="csl-entry" role="listitem">
Hijmans, Robert J. 2024. <em>Terra: Spatial Data Analysis</em>. <a href="https://CRAN.R-project.org/package=terra">https://CRAN.R-project.org/package=terra</a>.
</div>
<div id="ref-jonsson_thermal_2001" class="csl-entry" role="listitem">
Jonsson, Bror, Torbjørn Forseth, Arne. J. Jensen, and Tor. F. Næsje. 2001. <span>‘Thermal Performance of Juvenile <span>Atlantic</span> <span>Salmon</span>, <em><span>Salmo</span> Salar</em> <span>L</span>.’</span> <em>Functional Ecology</em> 15 (6): 701–11. <a href="https://doi.org/10.1046/j.0269-8463.2001.00572.x">https://doi.org/10.1046/j.0269-8463.2001.00572.x</a>.
</div>
<div id="ref-jonsson_energy_2003" class="csl-entry" role="listitem">
Jonsson, Nina, and Bror Jonsson. 2003. <span>‘Energy Allocation Among Developmental Stages, Age Groups, and Types of <span>Atlantic</span> Salmon (<em><span>Salmo</span> Salar</em>) Spawners’</span>. <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 60 (5): 506–16. <a href="https://doi.org/10.1139/f03-042">https://doi.org/10.1139/f03-042</a>.
</div>
<div id="ref-targets" class="csl-entry" role="listitem">
Landau, William Michael. 2021. <span>‘The Targets r Package: A Dynamic Make-Like Function-Oriented Pipeline Toolkit for Reproducibility and High-Performance Computing’</span>. <em>Journal of Open Source Software</em> 6 (57): 2959. <a href="https://doi.org/10.21105/joss.02959">https://doi.org/10.21105/joss.02959</a>.
</div>
<div id="ref-macnaughton_using_2019" class="csl-entry" role="listitem">
Macnaughton, Camille J., David Deslauriers, Erinn L. Ipsen, Emily Corey, and Eva C. Enders. 2019. <span>‘Using Meta-Analysis to Derive a Respiration Model for <span>Atlantic</span> Salmon (<em><span>Salmo</span> Salar</em>) to Assess Bioenergetics Requirements of Juveniles in Two <span>Canadian</span> Rivers’</span>. <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 76 (12): 2225–34. <a href="https://doi.org/10.1139/cjfas-2018-0436">https://doi.org/10.1139/cjfas-2018-0436</a>.
</div>
<div id="ref-rnaturalearth" class="csl-entry" role="listitem">
Massicotte, Philippe, and Andy South. n.d. <em>Rnaturalearth: World Map Data from Natural Earth</em>. <a href="https://github.com/ropensci/rnaturalearth">https://github.com/ropensci/rnaturalearth</a>.
</div>
<div id="ref-sf" class="csl-entry" role="listitem">
Pebesma, Edzer. 2018. <span>‘Simple Features for r: Standardized Support for Spatial Vector Data’</span>. <em>The R Journal</em> 10 (1): 439–46. <a href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-units" class="csl-entry" role="listitem">
Pebesma, Edzer, Thomas Mailund, and James Hiebert. 2016. <span>‘Measurement Units in <span>R</span>’</span>. <em>R Journal</em> 8 (2): 486–94. <a href="https://doi.org/10.32614/RJ-2016-061">https://doi.org/10.32614/RJ-2016-061</a>.
</div>
<div id="ref-poletto_unusual_2017" class="csl-entry" role="listitem">
Poletto, Jamilynn B., Dennis E. Cocherell, Sarah E. Baird, Trinh X. Nguyen, Valentina Cabrera-Stagno, Anthony P. Farrell, and Nann A. Fangue. 2017. <span>‘Unusual Aerobic Performance at High Temperatures in Juvenile <span>Chinook</span> Salmon, <em><span>Oncorhynchus</span> Tshawytscha</em>’</span>. <em>Conservation Physiology</em> 5 (1). <a href="https://doi.org/10.1093/conphys/cow067">https://doi.org/10.1093/conphys/cow067</a>.
</div>
<div id="ref-R_base" class="csl-entry" role="listitem">
R Core Team. 2019. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org">https://www.R-project.org</a>.
</div>
<div id="ref-arrow" class="csl-entry" role="listitem">
Richardson, Neal, Ian Cook, Nic Crane, Dewey Dunnington, Romain François, Jonathan Keane, Dragoș Moldovan-Grünfeld, Jeroen Ooms, Jacob Wujciak-Jens, and Apache Arrow. 2024. <span>‘Arrow: Integration to ’Apache’ ’Arrow’’</span>. <a href="https://CRAN.R-project.org/package=arrow">https://CRAN.R-project.org/package=arrow</a>.
</div>
<div id="ref-tvete_towards_2023" class="csl-entry" role="listitem">
Tvete, Ingunn Fride, Magne Aldrin, and Britt Bang Jensen. 2023. <span>‘Towards Better Survival: <span>Modeling</span> Drivers for Daily Mortality in <span>Norwegian</span> <span>Atlantic</span> Salmon Farming’</span>. <em>Preventive Veterinary Medicine</em> 210 (January): 105798. <a href="https://doi.org/10.1016/j.prevetmed.2022.105798">https://doi.org/10.1016/j.prevetmed.2022.105798</a>.
</div>
<div id="ref-uglem_does_2020" class="csl-entry" role="listitem">
Uglem, Ingebrigt, Kilian Toledo-Guedes, Pablo Sanchez-Jerez, Eva M. Ulvan, Tor Evensen, and Bjørn S. Sæther. 2020. <span>‘Does Waste Feed from Salmon Farming Affect the Quality of Saithe (<em><span>Pollachius</span> Virens</em> <span>L</span>.) Attracted to Fish Farms?’</span> <em>Aquaculture Research</em> 51 (4): 1720–30. <a href="https://doi.org/10.1111/are.14519">https://doi.org/10.1111/are.14519</a>.
</div>
<div id="ref-vadboncoeur_lowering_2023" class="csl-entry" role="listitem">
Vadboncoeur, Émile, Charlotte Nelson, Jennifer R. Hall, Kathy A. Clow, Rebeccah M. Sandrelli, Colin J. Brauner, Andrew K. Swanson, and A. Kurt Gamperl. 2023. <span>‘Lowering Temperature to 1&nbsp;°<span>C</span> Results in Physiological Changes, Stress and Mortality in Cultured <span>Atlantic</span> <span>Salmon</span> (<em><span>Salmo</span> Salar</em>)’</span>. <em>Aquaculture</em> 568 (April): 739313. <a href="https://doi.org/10.1016/j.aquaculture.2023.739313">https://doi.org/10.1016/j.aquaculture.2023.739313</a>.
</div>
<div id="ref-van_tien_development_2016" class="csl-entry" role="listitem">
Van Tien, Nguyen, Dam T. M. Chinh, Tran T. M. Huong, Truong H. Phuong, Simon Irvin, and Brett Glencross. 2016. <span>‘Development of a Nutritional Model to Define the Energy and Protein Requirements of Cobia, <em><span>Rachycentron</span> Canadum</em>’</span>. <em>Aquaculture</em> 463 (October): 193–200. <a href="https://doi.org/10.1016/j.aquaculture.2016.05.037">https://doi.org/10.1016/j.aquaculture.2016.05.037</a>.
</div>
<div id="ref-furrr" class="csl-entry" role="listitem">
Vaughan, Davis, and Matt Dancho. 2022. <em>Furrr: Apply Mapping Functions in Parallel Using Futures</em>. <a href="https://CRAN.R-project.org/package=furrr">https://CRAN.R-project.org/package=furrr</a>.
</div>
<div id="ref-ggplot2" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-stringr" class="csl-entry" role="listitem">
———. 2023. <em>Stringr: Simple, Consistent Wrappers for Common String Operations</em>. <a href="https://CRAN.R-project.org/package=stringr">https://CRAN.R-project.org/package=stringr</a>.
</div>
<div id="ref-dplyr" class="csl-entry" role="listitem">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis Vaughan. 2023. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
<div id="ref-tidyr" class="csl-entry" role="listitem">
Wickham, Hadley, Davis Vaughan, and Maximilian Girlich. 2024. <em>Tidyr: Tidy Messy Data</em>. <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.
</div>
<div id="ref-tinytex" class="csl-entry" role="listitem">
Xie, Yihui. 2017. <span>‘Tinytex: Helper Functions to Install and Maintain TeX Live, and Compile LaTeX Documents’</span>. <a href="https://cran.r-project.org/web/packages/tinytex">https://cran.r-project.org/web/packages/tinytex</a>.
</div>
</div>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"descPosition":"bottom","loop":false,"selector":".lightbox","closeEffect":"zoom","openEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script> 
  
</body></html>